

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spherical Linear Operators &mdash; pycsphere 1.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spherical Meshes" href="meshes.html" />
    <link rel="prev" title="Pycsou-sphere API" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pycsphere
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Pycsou-sphere API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spherical Linear Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="meshes.html">Spherical Meshes</a></li>
<li class="toctree-l2"><a class="reference internal" href="green.html">Zonal Green Kernels</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notes/index.html">Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pycsphere</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Pycsou-sphere API</a> &raquo;</li>
        
      <li>Spherical Linear Operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/linop.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pycsphere.linop">
<span id="spherical-linear-operators"></span><h1>Spherical Linear Operators<a class="headerlink" href="#module-pycsphere.linop" title="Permalink to this headline">¶</a></h1>
<p>Common spherical linear operators.</p>
<p class="rubric">Convolution/Pooling</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsphere.linop.ZonalSphericalConvolution" title="pycsphere.linop.ZonalSphericalConvolution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ZonalSphericalConvolution</span></code></a>(size[, …])</p></td>
<td><p>Zonal spherical convolution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsphere.linop.SphericalPooling" title="pycsphere.linop.SphericalPooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SphericalPooling</span></code></a>(nside_in, nside_out[, …])</p></td>
<td><p>Spherical pooling operator.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Differential Operators</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsphere.linop.DiscreteSphericalLaplacian" title="pycsphere.linop.DiscreteSphericalLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DiscreteSphericalLaplacian</span></code></a>(point_set[, dtype])</p></td>
<td><p>Discrete spherical Laplacian.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsphere.linop.DiscreteSphericalGradient" title="pycsphere.linop.DiscreteSphericalGradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DiscreteSphericalGradient</span></code></a>(point_set[, dtype])</p></td>
<td><p>Discrete spherical gradient.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Transforms</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsphere.linop.SphericalHarmonicTransform" title="pycsphere.linop.SphericalHarmonicTransform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SphericalHarmonicTransform</span></code></a>(n_max[, …])</p></td>
<td><p>Spherical Harmonic Transform (SHT).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsphere.linop.SHT" title="pycsphere.linop.SHT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SHT</span></code></a></p></td>
<td><p>alias of <a class="reference internal" href="#pycsphere.linop.SphericalHarmonicTransform" title="pycsphere.linop.SphericalHarmonicTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsphere.linop.SphericalHarmonicTransform</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsphere.linop.FourierLegendreTransform" title="pycsphere.linop.FourierLegendreTransform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FourierLegendreTransform</span></code></a>(n_max, t[, dtype])</p></td>
<td><p>Fourier Legendre Transform (FLT).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsphere.linop.FLT" title="pycsphere.linop.FLT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FLT</span></code></a></p></td>
<td><p>alias of <a class="reference internal" href="#pycsphere.linop.FourierLegendreTransform" title="pycsphere.linop.FourierLegendreTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsphere.linop.FourierLegendreTransform</span></code></a></p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="pycsphere.linop.ZonalSphericalConvolution">
<em class="property">class </em><code class="sig-name descname">ZonalSphericalConvolution</code><span class="sig-paren">(</span><em class="sig-param">size: int</em>, <em class="sig-param">spectral_window: Optional[numpy.ndarray] = None</em>, <em class="sig-param">zonal_filter: Optional[numpy.ndarray] = None</em>, <em class="sig-param">n_filter: Optional[int] = None</em>, <em class="sig-param">sigma: Optional[float] = None</em>, <em class="sig-param">use_weights: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#ZonalSphericalConvolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.ZonalSphericalConvolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou/html/api/classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="(in pycsou v1.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Zonal spherical convolution.</p>
<p>Compute the convolution between a bandlimited <em>zonal kernel</em> <span class="math notranslate nohighlight">\(\psi(\langle\mathbf{r},\mathbf{s}\rangle)\)</span> and a bandlimited <em>spherical map</em> <span class="math notranslate nohighlight">\(f(\mathbf{r})\)</span>:</p>
<div class="math notranslate nohighlight">
\[\left\{\psi\ast f\right\}(\mathbf{r})=\int_{\mathbb{S}^{2}}\psi(\langle\mathbf{r},\mathbf{s}\rangle)f(\mathbf{s})\,d\mathbf{s},\quad \forall \mathbf{r}\in\mathbb{S}^{2}.\]</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">healpy</span> <span class="k">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsphere.linop</span> <span class="kn">import</span> <span class="n">SHT</span><span class="p">,</span> <span class="n">FLT</span><span class="p">,</span> <span class="n">ZonalSphericalConvolution</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>

<span class="n">n_max</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">nside</span> <span class="o">=</span> <span class="n">SHT</span><span class="o">.</span><span class="n">nmax2nside</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">hp</span><span class="o">.</span><span class="n">nside2npix</span><span class="p">(</span><span class="n">nside</span><span class="o">=</span><span class="n">nside</span><span class="p">)))</span>
<span class="n">n</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">spectral_window</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">100</span><span class="o">+</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
<span class="n">flt</span><span class="o">=</span><span class="n">FLT</span><span class="p">(</span><span class="n">n_max</span><span class="o">=</span><span class="mi">1999</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2048</span><span class="p">))</span>
<span class="n">zonal_filter</span><span class="o">=</span><span class="n">flt</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">spectral_window</span><span class="p">)</span>
<span class="n">zonal_filter_interp</span><span class="o">=</span><span class="n">interp1d</span><span class="p">(</span><span class="n">flt</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">zonal_filter</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">convOp</span> <span class="o">=</span> <span class="n">ZonalSphericalConvolution</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">map_in</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">spectral_window</span><span class="o">=</span><span class="n">spectral_window</span><span class="p">)</span>
<span class="n">map_smoothed</span> <span class="o">=</span> <span class="n">convOp</span><span class="p">(</span><span class="n">map_in</span><span class="p">)</span>
<span class="n">map_bismoothed</span> <span class="o">=</span> <span class="n">convOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">map_smoothed</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">map_in</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Input Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">zonal_filter_interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Angular section of Zonal Filter&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">map_smoothed</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Smoothed Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">map_bismoothed</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Backprojected Smoothed Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/linop-1.py">Source code</a>)</p>
<div class="figure align-default" id="id5">
<img alt="../_images/linop-1_00.png" src="../_images/linop-1_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-1_00.png">png</a>, <a class="reference external" href="../api/linop-1_00.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-1_00.pdf">pdf</a>)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<img alt="../_images/linop-1_01.png" src="../_images/linop-1_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-1_01.png">png</a>, <a class="reference external" href="../api/linop-1_01.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-1_01.pdf">pdf</a>)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<img alt="../_images/linop-1_02.png" src="../_images/linop-1_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-1_02.png">png</a>, <a class="reference external" href="../api/linop-1_02.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-1_02.pdf">pdf</a>)</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id8">
<img alt="../_images/linop-1_03.png" src="../_images/linop-1_03.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-1_03.png">png</a>, <a class="reference external" href="../api/linop-1_03.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-1_03.pdf">pdf</a>)</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ZonalSphericalConvolution</span></code> operator is <em>self-adjoint</em> and can be computed efficiently in the spherical harmonic domain:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left\{\psi\ast f\right\}(\mathbf{r})&amp;=\int_{\mathbb{S}^{2}}\psi(\langle\mathbf{r},\mathbf{s}\rangle)f(\mathbf{s})\,d\mathbf{s}\\
&amp;= \sum_{n=0}^N\hat{\psi}_n\sum_{m=-n}^n \hat{f}_n^m Y_n^m(\mathbf{r}),\quad \forall \mathbf{r}\in\mathbb{S}^{2},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(N\)</span> is the maximum between the bandwidth of <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(\psi\)</span>. To perform this computation, we use
the routine <a class="reference external" href="https://healpy.readthedocs.io/en/latest/generated/healpy.sphtfunc.smoothing.html#healpy.sphtfunc.smoothing" title="(in healpy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">healpy.sphtfunc.smoothing()</span></code></a> which assumes a RING-ordered HEALPix discretisation of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This class is for <em>real</em> spherical maps <span class="math notranslate nohighlight">\(f\)</span> <strong>only</strong>.</p></li>
<li><p>Using this operator on non-bandlimited spherical maps <span class="math notranslate nohighlight">\(f\)</span> incurs aliasing.</p></li>
<li><p>HEALPix maps used as inputs must be <strong>RING ordered</strong>.</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsphere.linop.SphericalHarmonicTransform" title="pycsphere.linop.SphericalHarmonicTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">SphericalHarmonicTransform</span></code></a>, <a class="reference internal" href="#pycsphere.linop.FourierLegendreTransform" title="pycsphere.linop.FourierLegendreTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">FourierLegendreTransform</span></code></a>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">BiZonalSphericalConvolution</span></code></p>
</div>
<dl class="method">
<dt id="pycsphere.linop.ZonalSphericalConvolution.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">size: int</em>, <em class="sig-param">spectral_window: Optional[numpy.ndarray] = None</em>, <em class="sig-param">zonal_filter: Optional[numpy.ndarray] = None</em>, <em class="sig-param">n_filter: Optional[int] = None</em>, <em class="sig-param">sigma: Optional[float] = None</em>, <em class="sig-param">use_weights: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#ZonalSphericalConvolution.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.ZonalSphericalConvolution.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of the RING-ordered, HEALPix-discretised sherical map <span class="math notranslate nohighlight">\(f\)</span>.</p></li>
<li><p><strong>spectral_window</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Fourier-Legendre coefficients <span class="math notranslate nohighlight">\(\hat{\psi}_n\)</span> of the zonal filter. Overrides <code class="docutils literal notranslate"><span class="pre">zonal_filter</span></code>, <code class="docutils literal notranslate"><span class="pre">n_filter</span></code>
and <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p></li>
<li><p><strong>zonal_filter</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Zonal filter <span class="math notranslate nohighlight">\(\psi\)</span> discretised on [-1,1]. Overrides <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p></li>
<li><p><strong>n_filter</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em>) – Bandwidth of the zonal filter <span class="math notranslate nohighlight">\(\psi\)</span>. Only used if <code class="docutils literal notranslate"><span class="pre">zonal_filter</span></code> is specified.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Standard deviation of a Gaussian filter in radians.</p></li>
<li><p><strong>use_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use the ring weighting quadrature rule when computing the spherical harmonic transform.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The zonal filter can be specified in three ways:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Via its Fourier-Legendre coefficients (keyword <code class="docutils literal notranslate"><span class="pre">spectral_window</span></code>).</p></li>
<li><p>Via its discretisation on [-1,1] and its bandwidth  (keywords <code class="docutils literal notranslate"><span class="pre">zonal_filter</span></code> and <code class="docutils literal notranslate"><span class="pre">n_filter</span></code>).</p></li>
<li><p>As a spherical Gaussian filter with standard deviation <code class="docutils literal notranslate"><span class="pre">sigma</span></code> in radians.</p></li>
</ol>
</div></blockquote>
<p>If keywords from multiple scenarios are used, 1. overrides  2. and 3. and 2. overrides 3.</p>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.ZonalSphericalConvolution.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">map_in: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#ZonalSphericalConvolution.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.ZonalSphericalConvolution.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsphere.linop.SphericalPooling">
<em class="property">class </em><code class="sig-name descname">SphericalPooling</code><span class="sig-paren">(</span><em class="sig-param">nside_in: int</em>, <em class="sig-param">nside_out: int</em>, <em class="sig-param">order_in: str = 'RING'</em>, <em class="sig-param">order_out: str = 'RING'</em>, <em class="sig-param">pooling_func: str = 'mean'</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalPooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalPooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou/html/api/classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="(in pycsou v1.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Spherical pooling operator.</p>
<p>Pool an HEALPix map by summing/averaging children pixels nested in a common superpixel.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">healpy</span> <span class="k">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsphere.linop</span> <span class="kn">import</span> <span class="n">SphericalPooling</span>

<span class="n">nside</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">hp</span><span class="o">.</span><span class="n">nside2npix</span><span class="p">(</span><span class="n">nside</span><span class="o">=</span><span class="n">nside</span><span class="p">))</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">smoothing</span><span class="p">(</span><span class="n">map_in</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">pool</span> <span class="o">=</span> <span class="n">SphericalPooling</span><span class="p">(</span><span class="n">nside_in</span><span class="o">=</span><span class="n">nside</span><span class="p">,</span> <span class="n">nside_out</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">pooling_func</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
<span class="n">pooled_map</span> <span class="o">=</span> <span class="n">pool</span><span class="p">(</span><span class="n">map_in</span><span class="p">)</span>
<span class="n">backprojected_map</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">pooled_map</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">map_in</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Input Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">pooled_map</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pooled Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">backprojected_map</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Backprojected Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/linop-2.py">Source code</a>)</p>
<div class="figure align-default" id="id9">
<img alt="../_images/linop-2_00.png" src="../_images/linop-2_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-2_00.png">png</a>, <a class="reference external" href="../api/linop-2_00.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-2_00.pdf">pdf</a>)</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id10">
<img alt="../_images/linop-2_01.png" src="../_images/linop-2_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-2_01.png">png</a>, <a class="reference external" href="../api/linop-2_01.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-2_01.pdf">pdf</a>)</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id11">
<img alt="../_images/linop-2_02.png" src="../_images/linop-2_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-2_02.png">png</a>, <a class="reference external" href="../api/linop-2_02.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-2_02.pdf">pdf</a>)</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Pooling is performed via the function <a class="reference external" href="https://healpy.readthedocs.io/en/latest/generated/healpy.pixelfunc.ud_grade.html#healpy.pixelfunc.ud_grade" title="(in healpy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">healpy.pixelfunc.ud_grade()</span></code></a> from Healpy.
The adjoint (<em>unpooling</em>) is performed by assigning the value of the superpixels through the pooling function (e.g. mean, sum) to each children
pixels of the superpixels.</p>
<dl class="method">
<dt id="pycsphere.linop.SphericalPooling.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">nside_in: int</em>, <em class="sig-param">nside_out: int</em>, <em class="sig-param">order_in: str = 'RING'</em>, <em class="sig-param">order_out: str = 'RING'</em>, <em class="sig-param">pooling_func: str = 'mean'</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalPooling.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalPooling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nside_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Parameter NSIDE of the input HEALPix map.</p></li>
<li><p><strong>nside_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Parameter NSIDE of the pooled HEALPix map.</p></li>
<li><p><strong>order_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> [</em><em>'RING'</em><em>, </em><em>'NESTED'</em><em>]</em>) – Ordering of the input HEALPix map.</p></li>
<li><p><strong>order_out</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> [</em><em>'RING'</em><em>, </em><em>'NESTED'</em><em>]</em>) – Ordering of the pooled HEALPix map.</p></li>
<li><p><strong>pooling_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> [</em><em>'mean'</em><em>, </em><em>'sum'</em><em>]</em>) – Pooling function.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Data type of the linear operator.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">nside_out</span> <span class="pre">&gt;=</span> <span class="pre">nside_in</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.SphericalPooling.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">pooled_map: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalPooling.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalPooling.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsphere.linop.DiscreteSphericalLaplacian">
<em class="property">class </em><code class="sig-name descname">DiscreteSphericalLaplacian</code><span class="sig-paren">(</span><em class="sig-param">point_set: pycsphere.mesh.SphericalPointSet</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#DiscreteSphericalLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.DiscreteSphericalLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou-gsp/html/api/operators/pycgsp.linop.diff.html#pycgsp.linop.diff.GraphLaplacian" title="(in pycgsp v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycgsp.linop.diff.GraphLaplacian</span></code></a></p>
<p>Discrete spherical Laplacian.</p>
<p>Finite-difference approximation of the continuous spherical Laplacian for a map defined over a
<a class="reference internal" href="meshes.html#pycsphere.mesh.SphericalPointSet" title="pycsphere.mesh.SphericalPointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">SphericalPointSet</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">healpy</span> <span class="k">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsphere.mesh</span> <span class="kn">import</span> <span class="n">HEALPixPointSet</span>
<span class="kn">from</span> <span class="nn">pycsphere.linop</span> <span class="kn">import</span> <span class="n">DiscreteSphericalLaplacian</span>

<span class="n">nside</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">hp</span><span class="o">.</span><span class="n">nside2npix</span><span class="p">(</span><span class="n">nside</span><span class="o">=</span><span class="n">nside</span><span class="p">))</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">smoothing</span><span class="p">(</span><span class="n">map_in</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">)</span>
<span class="n">laplacian</span> <span class="o">=</span> <span class="n">DiscreteSphericalLaplacian</span><span class="p">(</span><span class="n">point_set</span><span class="o">=</span><span class="n">HEALPixPointSet</span><span class="p">(</span><span class="n">nside</span><span class="o">=</span><span class="n">nside</span><span class="p">))</span>
<span class="n">map_d2</span> <span class="o">=</span> <span class="n">laplacian</span><span class="p">(</span><span class="n">map_in</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">map_in</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Input Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">map_d2</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Magnitude of Laplacian Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/linop-3.py">Source code</a>)</p>
<div class="figure align-default" id="id12">
<img alt="../_images/linop-3_00.png" src="../_images/linop-3_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-3_00.png">png</a>, <a class="reference external" href="../api/linop-3_00.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-3_00.pdf">pdf</a>)</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id13">
<img alt="../_images/linop-3_01.png" src="../_images/linop-3_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-3_01.png">png</a>, <a class="reference external" href="../api/linop-3_01.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-3_01.pdf">pdf</a>)</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The discrete Laplacian is computed as the Laplacian of the spherical point set’s graph <a class="reference external" href="https://matthieumeo.github.io/pycsou-gsp/html/api/graphs/index.html#module-pycgsp.graph.__init__">Pycsou-gsp tessellation graphs</a> using
<a class="reference external" href="https://matthieumeo.github.io/pycsou-gsp/html/api/operators/pycgsp.linop.diff.html#pycgsp.linop.diff.GraphLaplacian" title="(in pycgsp v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycgsp.linop.diff.GraphLaplacian</span></code></a>.</p>
<dl class="method">
<dt id="pycsphere.linop.DiscreteSphericalLaplacian.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">point_set: pycsphere.mesh.SphericalPointSet</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#DiscreteSphericalLaplacian.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.DiscreteSphericalLaplacian.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_set</strong> (<a class="reference internal" href="meshes.html#pycsphere.mesh.SphericalPointSet" title="pycsphere.mesh.SphericalPointSet"><em>SphericalPointSet</em></a>) – Spherical point set on which the signal is defined.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Input type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsphere.linop.DiscreteSphericalGradient">
<em class="property">class </em><code class="sig-name descname">DiscreteSphericalGradient</code><span class="sig-paren">(</span><em class="sig-param">point_set: pycsphere.mesh.SphericalPointSet</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#DiscreteSphericalGradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.DiscreteSphericalGradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou-gsp/html/api/operators/pycgsp.linop.diff.html#pycgsp.linop.diff.GraphGradient" title="(in pycgsp v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycgsp.linop.diff.GraphGradient</span></code></a></p>
<p>Discrete spherical gradient.</p>
<p>Finite-difference approximation of the continuous spherical gradient for a map defined over a
<a class="reference internal" href="meshes.html#pycsphere.mesh.SphericalPointSet" title="pycsphere.mesh.SphericalPointSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">SphericalPointSet</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>The discrete gradient is computed as the gradient of the spherical point set’s graph (see <a class="reference external" href="https://matthieumeo.github.io/pycsou-gsp/html/api/graphs/index.html#module-pycgsp.graph.__init__">Pycsou-gsp tessellation graphs</a>)
using <a class="reference external" href="https://matthieumeo.github.io/pycsou-gsp/html/api/operators/pycgsp.linop.diff.html#pycgsp.linop.diff.GraphGradient" title="(in pycgsp v1.0.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycgsp.linop.diff.GraphGradient</span></code></a>.</p>
<dl class="method">
<dt id="pycsphere.linop.DiscreteSphericalGradient.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">point_set: pycsphere.mesh.SphericalPointSet</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#DiscreteSphericalGradient.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.DiscreteSphericalGradient.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>point_set</strong> (<a class="reference internal" href="meshes.html#pycsphere.mesh.SphericalPointSet" title="pycsphere.mesh.SphericalPointSet"><em>SphericalPointSet</em></a>) – Spherical point set on which the signal is defined.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Input type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsphere.linop.SphericalHarmonicTransform">
<em class="property">class </em><code class="sig-name descname">SphericalHarmonicTransform</code><span class="sig-paren">(</span><em class="sig-param">n_max: int</em>, <em class="sig-param">use_weights: bool = False</em>, <em class="sig-param">verbose: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou/html/api/classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="(in pycsou v1.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Spherical Harmonic Transform (SHT).</p>
<p>Compute the spherical harmonic transform of a <strong>real</strong> bandlimited spherical function <span class="math notranslate nohighlight">\(f:\mathbb{S}^2\to\mathbb{R}\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">healpy</span> <span class="k">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsphere.linop</span> <span class="kn">import</span> <span class="n">SHT</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">n_max</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">nside</span> <span class="o">=</span> <span class="n">SHT</span><span class="o">.</span><span class="n">nmax2nside</span><span class="p">(</span><span class="n">n_max</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">hp</span><span class="o">.</span><span class="n">nside2npix</span><span class="p">(</span><span class="n">nside</span><span class="o">=</span><span class="n">nside</span><span class="p">)))</span>
<span class="n">map_in</span> <span class="o">=</span> <span class="n">hp</span><span class="o">.</span><span class="n">smoothing</span><span class="p">(</span><span class="n">map_in</span><span class="p">,</span> <span class="n">beam_window</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">n_max</span><span class="o">//</span><span class="mi">4</span><span class="p">,)))</span>
<span class="n">sht</span> <span class="o">=</span> <span class="n">SHT</span><span class="p">(</span><span class="n">n_max</span><span class="o">=</span><span class="n">n_max</span><span class="p">)</span>
<span class="n">anm</span> <span class="o">=</span> <span class="n">sht</span><span class="p">(</span><span class="n">map_in</span><span class="p">)</span>
<span class="n">synth_map</span> <span class="o">=</span> <span class="n">sht</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">anm</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">map_in</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Input Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">sht</span><span class="o">.</span><span class="n">plot_anm</span><span class="p">(</span><span class="n">anm</span><span class="p">)</span>
<span class="n">hp</span><span class="o">.</span><span class="n">mollview</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="n">synth_map</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Synthesised Map&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/linop-4.py">Source code</a>)</p>
<div class="figure align-default" id="id14">
<img alt="../_images/linop-4_00.png" src="../_images/linop-4_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-4_00.png">png</a>, <a class="reference external" href="../api/linop-4_00.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-4_00.pdf">pdf</a>)</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id15">
<img alt="../_images/linop-4_01.png" src="../_images/linop-4_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-4_01.png">png</a>, <a class="reference external" href="../api/linop-4_01.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-4_01.pdf">pdf</a>)</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id16">
<img alt="../_images/linop-4_02.png" src="../_images/linop-4_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-4_02.png">png</a>, <a class="reference external" href="../api/linop-4_02.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-4_02.pdf">pdf</a>)</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Every function <span class="math notranslate nohighlight">\(f\in\mathcal{L}^2(\mathbb{S}^{2})\)</span> admits a <em>spherical Fourier expansion</em> given by</p>
<div class="math notranslate nohighlight">
\[f\stackrel{\mathcal{L}^2}{=}\sum_{n=0}^{+\infty}\sum_{m=-n}^{n} \,\hat{a}_n^m \,Y_n^m,\]</div>
<p>where the <em>spherical harmonic coefficients</em> <span class="math notranslate nohighlight">\(\{\hat{a}_n^m\}\subset\mathbb{C}\)</span> of <span class="math notranslate nohighlight">\(f\)</span> are given by the <em>Spherical Harmonic Transform</em>:</p>
<div class="math notranslate nohighlight">
\[\hat{a}_n^m=\int_{0}^\pi\int_{-\pi}^\pi f(\phi,\theta) \overline{Y_n^m(\phi,\theta)} \,\sin(\theta)d\phi d\theta.\]</div>
<p>The functions <span class="math notranslate nohighlight">\(Y_n^m:[-\pi,\pi[\times [0,\pi]\to \mathbb{C}\)</span> are called the <em>spherical harmonics</em> and are given by:</p>
<div class="math notranslate nohighlight">
\[Y_n^m(\phi,\theta):=\sqrt{\frac{(2n+1)(n-m)!}{4\pi (n+m)!}}P_n^m(\cos(\theta))e^{j m\phi}, \;\forall (\phi,\theta)\in[-\pi,\pi[\times [0,\pi],\]</div>
<p>where <span class="math notranslate nohighlight">\(P_n^m:[-1,1]\rightarrow \mathbb{R}\)</span> denote the <em>associated Legendre functions</em> (see Chapter 1 of <a class="reference internal" href="../notes/references.html#rafaely" id="id2"><span>[Rafaely]</span></a>).</p>
<p>For bandlimited functions of order <span class="math notranslate nohighlight">\(N\in\mathbb{N}\)</span> (<span class="math notranslate nohighlight">\(|\hat{a}_n^m|=0\forall n&gt;N\)</span>), the spherical harmonic coefficients
can be approximated very accurately via the spherical quadrature rule (see <a class="reference external" href="https://healpix.sourceforge.io/html/fac_anafast.htm">HEALPix help</a>):</p>
<div class="math notranslate nohighlight">
\[\hat{a}_n^m=\frac{4\pi}{N_{pix}}\sum_{p=1}^{N_{pix}} f(\phi_p,\theta_p) \overline{Y_n^m(\phi_p,\theta_p)}\]</div>
<p>assuming a HEALPix spherical point set  <span class="math notranslate nohighlight">\(\left\{\mathbf{r}_p(\phi_p,\theta_p)\in\mathbb{S}^2, p=1, \ldots, N_{pix}=12N_{side}^2\right\}\)</span> with
<span class="math notranslate nohighlight">\(2 N_{side}&lt;N\leq 3 N_{side}-1\)</span>. The spherical harmonic transform and its inverse (adjoint) are computed with the routines
<a class="reference external" href="https://healpy.readthedocs.io/en/latest/generated/healpy.sphtfunc.map2alm.html#healpy.sphtfunc.map2alm" title="(in healpy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">healpy.sphtfunc.map2alm()</span></code></a> and <a class="reference external" href="https://healpy.readthedocs.io/en/latest/generated/healpy.sphtfunc.alm2map.html#healpy.sphtfunc.alm2map" title="(in healpy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">healpy.sphtfunc.alm2map()</span></code></a> which compute the spherical harmonics efficiently via
recurrence relations for Legendre polynomials on co-latitudes, and Fast Fourier Transforms on longitudes (see <a class="reference external" href="https://healpix.sourceforge.io/html/fac_anafast.htm">HEALPix help</a>).
If accuracy is a concern, ring-based quadrature rules can also be used with  the keyword <code class="docutils literal notranslate"><span class="pre">use_weights=True</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul class="simple">
<li><p>This class is for real spherical maps <strong>only</strong>. Complex spherical maps are not supported yet by the routines
<a class="reference external" href="https://healpy.readthedocs.io/en/latest/generated/healpy.sphtfunc.map2alm.html#healpy.sphtfunc.map2alm" title="(in healpy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">healpy.sphtfunc.map2alm()</span></code></a> and <a class="reference external" href="https://healpy.readthedocs.io/en/latest/generated/healpy.sphtfunc.alm2map.html#healpy.sphtfunc.alm2map" title="(in healpy v1.14.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">healpy.sphtfunc.alm2map()</span></code></a> which compute only half of the spherical harmonic coefficients,
assuming symmetry.</p></li>
<li><p>Using this operator on non-bandlimited spherical maps incurs aliasing.</p></li>
<li><p>HEALPix maps used as inputs must be <strong>RING ordered</strong>.</p></li>
</ul>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsphere.linop.SHT" title="pycsphere.linop.SHT"><code class="xref py py-class docutils literal notranslate"><span class="pre">SHT</span></code></a>, <a class="reference internal" href="#pycsphere.linop.FourierLegendreTransform" title="pycsphere.linop.FourierLegendreTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">FourierLegendreTransform</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsphere.linop.SphericalHarmonicTransform.nmax2nside">
<em class="property">classmethod </em><code class="sig-name descname">nmax2nside</code><span class="sig-paren">(</span><em class="sig-param">n_max: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform.nmax2nside"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform.nmax2nside" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the critical HEALPix NSIDE parameter for a given bandwidth <code class="docutils literal notranslate"><span class="pre">n_max</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Bandwidth of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The critical HEALPix NSIDE parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.SphericalHarmonicTransform.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">n_max: int</em>, <em class="sig-param">use_weights: bool = False</em>, <em class="sig-param">verbose: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Bandwidth of the map.</p></li>
<li><p><strong>use_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – <p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use ring-based quadrature weights (more accurate), otherwise use uniform quadrature weights.
See <a class="reference external" href="https://healpix.sourceforge.io/html/fac_anafast.htm">HEALPix help</a> for more information.</p>
</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code> prints diagnostic information.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.SphericalHarmonicTransform.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">anm: numpy.ndarray</em>, <em class="sig-param">nside: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the inverse spherical harmonic transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>anm</strong> (<em>np.ndarray</em>) – Spherical harmonic coefficients <span class="math notranslate nohighlight">\(\{\hat{a}_n^m\}\subset\mathbb{C}\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Synthesised bandlimited spherical map discretised on a critical RING ordered HEALPix mesh.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.SphericalHarmonicTransform.anm2cn">
<code class="sig-name descname">anm2cn</code><span class="sig-paren">(</span><em class="sig-param">anm: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform.anm2cn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform.anm2cn" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the angular power spectrum.</p>
<p>The <em>angular power spectrum</em> is defined as:</p>
<div class="math notranslate nohighlight">
\[\hat{c}_n:=\frac{1}{2n+1}\sum_{m=-n}^n |\hat{a}_n^m|^2, \quad n\in \mathbb{N}.\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>anm</strong> (<em>np.ndarray</em>) – Spherical harmonic coefficients <span class="math notranslate nohighlight">\(\{\hat{a}_n^m\}\subset\mathbb{C}\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The <em>angular power spectrum</em> coefficients <span class="math notranslate nohighlight">\(\hat{c}_n\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.SphericalHarmonicTransform.anm_triangle">
<code class="sig-name descname">anm_triangle</code><span class="sig-paren">(</span><em class="sig-param">anm: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform.anm_triangle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform.anm_triangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Arrange the spherical harmonic coefficients in a lower-triangular matrix where each row represents a level <span class="math notranslate nohighlight">\(n\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>anm</strong> (<em>np.ndarray</em>) – Spherical harmonic coefficients.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Spherical harmonic coefficients arranged in a lower-triangular matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.SphericalHarmonicTransform.plot_anm">
<code class="sig-name descname">plot_anm</code><span class="sig-paren">(</span><em class="sig-param">anm: numpy.ndarray</em>, <em class="sig-param">cmap: str = 'viridis'</em>, <em class="sig-param">cast: Callable = &lt;ufunc 'absolute'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#SphericalHarmonicTransform.plot_anm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.SphericalHarmonicTransform.plot_anm" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the spherical harmonic coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anm</strong> (<em>np.ndarray</em>) – Spherical harmonic coefficients.</p></li>
<li><p><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Colormap.</p></li>
<li><p><strong>cast</strong> (<em>Callable</em>) – Function to cast the complex coefficients into real coefficients (e.g. <code class="docutils literal notranslate"><span class="pre">np.abs</span></code>, <code class="docutils literal notranslate"><span class="pre">np.real</span></code>, <code class="docutils literal notranslate"><span class="pre">np.imag</span></code>…)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="pycsphere.linop.SHT">
<code class="sig-name descname">SHT</code><a class="headerlink" href="#pycsphere.linop.SHT" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pycsphere.linop.SphericalHarmonicTransform" title="pycsphere.linop.SphericalHarmonicTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsphere.linop.SphericalHarmonicTransform</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="pycsphere.linop.FourierLegendreTransform">
<em class="property">class </em><code class="sig-name descname">FourierLegendreTransform</code><span class="sig-paren">(</span><em class="sig-param">n_max: int</em>, <em class="sig-param">t: numpy.ndarray</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#FourierLegendreTransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.FourierLegendreTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou/html/api/classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="(in pycsou v1.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Fourier Legendre Transform (FLT).</p>
<p>Compute the Fourier Legendre Transform of a function <span class="math notranslate nohighlight">\(f:[-1,1]\to\mathbb{C}\)</span>. This is useful for computing the
spherical harmonics coefficients of spherical zonal functions of the form <span class="math notranslate nohighlight">\(g(\mathbf{r})=f(\langle\mathbf{r}, \mathbf{s}\rangle)\)</span>.
Indeed, for such functions, we have:</p>
<div class="math notranslate nohighlight">
\[\hat{g}_n^m=\hat{f}_n \sqrt{\frac{2n+1}{4\pi}}\delta_n^0, \quad \forall n,m,\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{f}_n\)</span> are the Fourier-Legendre coefficients of <span class="math notranslate nohighlight">\(f\)</span>.  Moreover, from the Fourier-Legendre expansion we have also:</p>
<div class="math notranslate nohighlight">
\[f(\langle\mathbf{r}, \mathbf{s}\rangle)=\sum_{n=0}^{+\infty} \hat{f}_n\frac{2n+1}{4\pi} P_n(\langle\mathbf{r}, \mathbf{s}\rangle).\]</div>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">healpy</span> <span class="k">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsphere.linop</span> <span class="kn">import</span> <span class="n">FLT</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">flt</span> <span class="o">=</span> <span class="n">FLT</span><span class="p">(</span><span class="n">n_max</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">bn</span> <span class="o">=</span> <span class="n">flt</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">trunc_fl_series</span> <span class="o">=</span> <span class="n">flt</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">bn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">flt</span><span class="o">.</span><span class="n">n_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">bn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$n$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier-Legendre coefficients&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">trunc_fl_series</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Truncated Fourier-Legendre Expansion&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/linop-5.py">Source code</a>)</p>
<div class="figure align-default" id="id17">
<img alt="../_images/linop-5_00.png" src="../_images/linop-5_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-5_00.png">png</a>, <a class="reference external" href="../api/linop-5_00.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-5_00.pdf">pdf</a>)</span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id18">
<img alt="../_images/linop-5_01.png" src="../_images/linop-5_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-5_01.png">png</a>, <a class="reference external" href="../api/linop-5_01.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-5_01.pdf">pdf</a>)</span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id19">
<img alt="../_images/linop-5_02.png" src="../_images/linop-5_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-5_02.png">png</a>, <a class="reference external" href="../api/linop-5_02.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-5_02.pdf">pdf</a>)</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">healpy</span> <span class="k">as</span> <span class="nn">hp</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsphere.linop</span> <span class="kn">import</span> <span class="n">FLT</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
<span class="n">bn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="n">flt</span> <span class="o">=</span> <span class="n">FLT</span><span class="p">(</span><span class="n">n_max</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">flt</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">bn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">flt</span><span class="o">.</span><span class="n">n_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">bn</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$n$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier-Legendre coefficients&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier-Legendre Expansion&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../api/linop-6.py">Source code</a>)</p>
<div class="figure align-default" id="id20">
<img alt="../_images/linop-6_00.png" src="../_images/linop-6_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-6_00.png">png</a>, <a class="reference external" href="../api/linop-6_00.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-6_00.pdf">pdf</a>)</span><a class="headerlink" href="#id20" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id21">
<img alt="../_images/linop-6_01.png" src="../_images/linop-6_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../api/linop-6_01.png">png</a>, <a class="reference external" href="../api/linop-6_01.hires.png">hires.png</a>, <a class="reference external" href="../api/linop-6_01.pdf">pdf</a>)</span><a class="headerlink" href="#id21" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Let <span class="math notranslate nohighlight">\(\{P_{n}:[-1,1]\rightarrow\mathbb{C}, \, n\in\mathbb{N}\}\)</span> be the <em>Legendre polynomials</em>.
Then, any  function <span class="math notranslate nohighlight">\(b\in\mathcal{L}^2([-1, 1], \mathbb{C})\)</span> admits a <em>Fourier-Legendre expansion</em> given by</p>
<div class="math notranslate nohighlight">
\[b(t)\stackrel{a.e.}{=}\sum_{n=0}^{+\infty} \hat{b}_n\,\frac{2n+1}{4\pi} P_{n}(t),\]</div>
<p>where the <em>Fourier-Legendre coefficients</em> are given by the <em>Fourier-Legendre transform</em></p>
<div class="math notranslate nohighlight">
\[\hat{b}_n:=2\pi \int_{-1}^1 b(t) P_{n}(t) \,dt, \quad n\geq 0.\]</div>
<p>This implementation of the Fourier-Legendre transform  leverages a
recurrence relationship for computing efficiently Legendre polynomials, and a trapezoidal rule for approximating the integral.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using this function with <code class="docutils literal notranslate"><span class="pre">n_max</span></code> smaller than the function’s bandwidth may result in aliasing/smoothing artefacts.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsphere.linop.FLT" title="pycsphere.linop.FLT"><code class="xref py py-class docutils literal notranslate"><span class="pre">FLT</span></code></a>, <a class="reference internal" href="#pycsphere.linop.SphericalHarmonicTransform" title="pycsphere.linop.SphericalHarmonicTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">SphericalHarmonicTransform</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsphere.linop.FourierLegendreTransform.nmax2t">
<em class="property">classmethod </em><code class="sig-name descname">nmax2t</code><span class="sig-paren">(</span><em class="sig-param">n_max: int</em>, <em class="sig-param">oversampling: float = 10.0</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#FourierLegendreTransform.nmax2t"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.FourierLegendreTransform.nmax2t" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate suitable samples <code class="docutils literal notranslate"><span class="pre">t</span></code> for a given <code class="docutils literal notranslate"><span class="pre">n_max</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Maximal Fourier-Legendre coefficient index <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p><strong>oversampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Oversampling factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Samples <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.FourierLegendreTransform.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">n_max: int</em>, <em class="sig-param">t: numpy.ndarray</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsphere/linop.html#FourierLegendreTransform.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.FourierLegendreTransform.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Maximal Fourier-Legendre coefficient index <span class="math notranslate nohighlight">\(n\)</span>.</p></li>
<li><p><strong>t</strong> (<em>np.ndarray</em>) – Grid of <span class="math notranslate nohighlight">\([-1,1]\)</span> used to approximate the integral when computing the Fourier-Legendre coefficients.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Data type of the operator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsphere.linop.FourierLegendreTransform.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">bn: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsphere/linop.html#FourierLegendreTransform.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsphere.linop.FourierLegendreTransform.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Fourier-Legendre series truncated at <code class="docutils literal notranslate"><span class="pre">n_max</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bn</strong> (<em>np.ndarray</em>) – Fourier-Legendre coefficients <span class="math notranslate nohighlight">\(\{\hat{b}_n, n=0,\ldots, n_{max}\}\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The Fourier-Legendre series truncated at <code class="docutils literal notranslate"><span class="pre">n_max</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="pycsphere.linop.FLT">
<code class="sig-name descname">FLT</code><a class="headerlink" href="#pycsphere.linop.FLT" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#pycsphere.linop.FourierLegendreTransform" title="pycsphere.linop.FourierLegendreTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsphere.linop.FourierLegendreTransform</span></code></a></p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="meshes.html" class="btn btn-neutral float-right" title="Spherical Meshes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Pycsou-sphere API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Matthieu SIMEONI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>