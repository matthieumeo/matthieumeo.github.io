

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Differential Operators &mdash; pycgsp 1.0.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tessellation Graphs" href="../graphs/index.html" />
    <link rel="prev" title="Convolution Operators" href="pycgsp.linop.conv.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pycgsp
          

          
          </a>

          
            
            
              <div class="version">
                1.0.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general/install.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Pycsou-GSP API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Linear Operators</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pycgsp.linop.conv.html">Convolution Operators</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Differential Operators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../graphs/index.html">Tessellation Graphs</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notes/index.html">Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pycgsp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Pycsou-GSP API</a> &raquo;</li>
        
          <li><a href="index.html">Linear Operators</a> &raquo;</li>
        
      <li>Differential Operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/operators/pycgsp.linop.diff.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="differential-operators">
<h1>Differential Operators<a class="headerlink" href="#differential-operators" title="Permalink to this headline">¶</a></h1>
<p>Base class for graph convolution operators.</p>
<span class="target" id="module-pycgsp.linop.diff"></span><p>Graph differential operators.</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycgsp.linop.diff.GraphLaplacian" title="pycgsp.linop.diff.GraphLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GraphLaplacian</span></code></a>(Graph[, dtype])</p></td>
<td><p>Graph Laplacian.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycgsp.linop.diff.GraphGradient" title="pycgsp.linop.diff.GraphGradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GraphGradient</span></code></a>(Graph[, dtype])</p></td>
<td><p>Graph gradient.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycgsp.linop.diff.GeneralisedGraphLaplacian" title="pycgsp.linop.diff.GeneralisedGraphLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian</span></code></a>(Graph[, kind])</p></td>
<td><p>Generalised graph Laplacian operator.</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="pycgsp.linop.diff.GraphLaplacian">
<em class="property">class </em><code class="sig-name descname">GraphLaplacian</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GraphLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GraphLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou/html/api/classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="(in pycsou v1.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Graph Laplacian.</p>
<p>Normalised graph Laplacian for signals defined on graphs.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pygsp.graphs</span> <span class="kn">import</span> <span class="n">Ring</span>
<span class="kn">from</span> <span class="nn">pycgsp.linop.diff</span> <span class="kn">import</span> <span class="n">GraphLaplacian</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Ring</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">lap_type</span><span class="o">=</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">])</span>
<span class="n">Lap</span> <span class="o">=</span> <span class="n">GraphLaplacian</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
<span class="n">lap_sig</span> <span class="o">=</span> <span class="n">Lap</span> <span class="o">*</span> <span class="n">signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">lap_sig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laplacian of signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">lap_sig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laplacian of signal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-1.py">Source code</a>)</p>
<div class="figure align-default" id="id4">
<img alt="../../_images/pycgsp-linop-diff-1_00.png" src="../../_images/pycgsp-linop-diff-1_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_00.png">png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_00.pdf">pdf</a>)</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id5">
<img alt="../../_images/pycgsp-linop-diff-1_01.png" src="../../_images/pycgsp-linop-diff-1_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_01.png">png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_01.pdf">pdf</a>)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<img alt="../../_images/pycgsp-linop-diff-1_02.png" src="../../_images/pycgsp-linop-diff-1_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_02.png">png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_02.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_02.pdf">pdf</a>)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<img alt="../../_images/pycgsp-linop-diff-1_03.png" src="../../_images/pycgsp-linop-diff-1_03.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_03.png">png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_03.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-1_03.pdf">pdf</a>)</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>For undirected graphs, the normalized graph Laplacian is defined as</p>
<div class="math notranslate nohighlight">
\[\mathbf{L} = \mathbf{I} - \mathbf{D}^{-1/2} \mathbf{W} \mathbf{D}^{-1/2},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix, <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> is the weighted adjacency matrix and <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> the
weighted degree matrix.</p>
<p>For directed graphs, the Laplacians are built from a symmetrized
version of the weighted adjacency matrix that is the average of the
weighted adjacency matrix and its transpose. As the Laplacian is
defined as the divergence of the gradient, it is not affected by the
orientation of the edges.</p>
<p>For both Laplacians, the diagonal entries corresponding to disconnected
nodes (i.e., nodes with degree zero) are set to zero.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GraphLaplacian</span></code> operator is self-adjoint.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycgsp.linop.diff.GraphGradient" title="pycgsp.linop.diff.GraphGradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphGradient</span></code></a>, <a class="reference internal" href="#pycgsp.linop.diff.GeneralisedGraphLaplacian" title="pycgsp.linop.diff.GeneralisedGraphLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian()</span></code></a>
<a class="reference internal" href="pycgsp.linop.conv.html#pycgsp.linop.conv.GraphConvolution" title="pycgsp.linop.conv.GraphConvolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphConvolution</span></code></a></p>
</div>
<dl class="method">
<dt id="pycgsp.linop.diff.GraphLaplacian.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GraphLaplacian.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GraphLaplacian.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Graph</strong> (<a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph">pygsp.graphs.Graph</a>) – Graph on which the signal is defined, with normalised Laplacian <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> precomputed (see <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph.compute_laplacian">pygsp.graphs.Graph.compute_laplacian(lap_type=’normalized’)</a>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the entries of the graph filer.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> does not exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.lap_type</span></code> is ‘combinatorial’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycgsp.linop.diff.GraphLaplacian.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GraphLaplacian.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GraphLaplacian.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycgsp.linop.diff.GraphGradient">
<em class="property">class </em><code class="sig-name descname">GraphGradient</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GraphGradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GraphGradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matthieumeo.github.io/pycsou/html/api/classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="(in pycsou v1.0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Graph gradient.</p>
<p>Gradient operator for signals defined on graphs.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Ring</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">lap_type</span><span class="o">=</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">compute_differential_operator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lap</span> <span class="o">=</span> <span class="n">GraphLaplacian</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Grad</span> <span class="o">=</span> <span class="n">GraphGradient</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lap_sig</span> <span class="o">=</span> <span class="n">Lap</span> <span class="o">*</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lap_sig2</span> <span class="o">=</span> <span class="n">Grad</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">Grad</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">lap_sig</span><span class="p">,</span> <span class="n">lap_sig2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The adjoint of the <code class="docutils literal notranslate"><span class="pre">GraphGradient</span></code> operator is called the graph divergence operator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In the newest version of PyGSP (&gt; 0.5.1) the convention is changed: <code class="docutils literal notranslate"><span class="pre">Graph.D</span></code> is the divergence operator and
<code class="docutils literal notranslate"><span class="pre">Graph.D.transpose()</span></code> the gradient (see routine <a class="reference external" href="https://pygsp.readthedocs.io/en/latest/reference/graphs.html#pygsp.graphs.Graph.compute_differential_operator">Graph.compute_differential_operator</a>). The code should be adapted when this new version is released.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycgsp.linop.diff.GraphLaplacian" title="pycgsp.linop.diff.GraphLaplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphLaplacian</span></code></a>, <a class="reference internal" href="#pycgsp.linop.diff.GeneralisedGraphLaplacian" title="pycgsp.linop.diff.GeneralisedGraphLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian()</span></code></a></p>
</div>
<dl class="method">
<dt id="pycgsp.linop.diff.GraphGradient.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GraphGradient.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GraphGradient.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Graph</strong> – Graph on which the signal is defined, with differential operator <code class="docutils literal notranslate"><span class="pre">Graph.D</span></code> precomputed (see <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph.compute_differential_operator">pygsp.graphs.Graph.compute_differential_operator()</a>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the entries of the graph filer.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.D</span></code> does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycgsp.linop.diff.GraphGradient.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GraphGradient.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GraphGradient.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycgsp.linop.diff.GeneralisedGraphLaplacian">
<code class="sig-name descname">GeneralisedGraphLaplacian</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">kind: str = 'iterated'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycgsp/linop/diff.html#GeneralisedGraphLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycgsp.linop.diff.GeneralisedGraphLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalised graph Laplacian operator.</p>
<p>Generalised Laplacian operator signals defined on graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Graph</strong> – <p>Graph on which the signal is defined, with normalised Laplacian <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> precomputed (see <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph.compute_laplacian">pygsp.graphs.Graph.compute_laplacian(lap_type=’normalized’)</a>.</p>
</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the entries of the graph filer.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – <p>Type of generalised differential operator (<code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>).
Depending on the cases, the <code class="docutils literal notranslate"><span class="pre">GeneralisedLaplacian</span></code> operator is defined as follows:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\mathbf{L}^N\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=(\alpha^2 \mathrm{Id}-\mathbf{L})^N\)</span>, with <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\sum_{n=0}^N \alpha_n \mathbf{L}^n\)</span>,  with <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> is the <a class="reference internal" href="#pycgsp.linop.diff.GraphLaplacian" title="pycgsp.linop.diff.GraphLaplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphLaplacian</span></code></a> operator.</p>
</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – <p>Additional arguments depending on the value of <code class="docutils literal notranslate"><span class="pre">kind</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int,</span> <span class="pre">constant:</span> <span class="pre">float}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span> and <code class="docutils literal notranslate"><span class="pre">constant</span></code> the scalar <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={coeffs:</span> <span class="pre">Union[np.ndarray,</span> <span class="pre">list,</span> <span class="pre">tuple]}</span></code> where <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> is an array containing the coefficients <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> does not exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.lap_type</span></code> is ‘combinatorial’.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">kind</span></code> is not ‘iterated’, ‘sobolev’ or ‘polynomial’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pygsp.graphs</span> <span class="kn">import</span> <span class="n">Ring</span>
<span class="kn">from</span> <span class="nn">pycgsp.linop.diff</span> <span class="kn">import</span> <span class="n">GeneralisedGraphLaplacian</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Ring</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">lap_type</span><span class="o">=</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">])</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">GeneralisedGraphLaplacian</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">gen_lap</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">gen_lap</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Generalized Laplacian of signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-2.py">Source code</a>)</p>
<div class="figure align-default" id="id8">
<img alt="../../_images/pycgsp-linop-diff-2_00.png" src="../../_images/pycgsp-linop-diff-2_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-2_00.png">png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-2_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-2_00.pdf">pdf</a>)</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id9">
<img alt="../../_images/pycgsp-linop-diff-2_01.png" src="../../_images/pycgsp-linop-diff-2_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycgsp-linop-diff-2_01.png">png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-2_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycgsp-linop-diff-2_01.pdf">pdf</a>)</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian</span></code> operator is self-adjoint.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycgsp.linop.diff.GraphLaplacian" title="pycgsp.linop.diff.GraphLaplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphLaplacian</span></code></a></p>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../graphs/index.html" class="btn btn-neutral float-right" title="Tessellation Graphs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pycgsp.linop.conv.html" class="btn btn-neutral float-left" title="Convolution Operators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Matthieu SIMEONI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>