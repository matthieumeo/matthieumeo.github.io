

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sampling Operators &mdash; pycsou 0.0.1.dev38 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cost Functionals" href="../functionals/index.html" />
    <link rel="prev" title="Differential Operators" href="pycsou.linop.diff.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> pycsou
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1.dev38
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classes/index.html">Abstract Classes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linear Operators</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pycsou.linop.base.html">Constructors</a></li>
<li class="toctree-l2"><a class="reference internal" href="pycsou.linop.conv.html">Convolution Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="pycsou.linop.diff.html">Differential Operators</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sampling Operators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../functionals/index.html">Cost Functionals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/index.html">Mathematical Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/index.html">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notes/index.html">Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pycsou</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Linear Operators</a> &raquo;</li>
        
      <li>Sampling Operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/operators/pycsou.linop.sampling.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pycsou.linop.sampling">
<span id="sampling-operators"></span><h1>Sampling Operators<a class="headerlink" href="#module-pycsou.linop.sampling" title="Permalink to this headline">¶</a></h1>
<p>Sampling operators.</p>
<p>This module provides sampling operators for discrete or continuous signals.</p>
<p class="rubric">Discrete Sampling Operators</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.sampling.SubSampling" title="pycsou.linop.sampling.SubSampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SubSampling</span></code></a>(size, sampling_indices[, shape, …])</p></td>
<td><p>Subsampling operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.sampling.Masking" title="pycsou.linop.sampling.Masking"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Masking</span></code></a>(size, sampling_bool[, dtype])</p></td>
<td><p>Masking operator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.sampling.DownSampling" title="pycsou.linop.sampling.DownSampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DownSampling</span></code></a>(size, downsampling_factor[, …])</p></td>
<td><p>Downsampling operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.sampling.Pooling" title="pycsou.linop.sampling.Pooling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Pooling</span></code></a>(shape, block_size[, pooling_func, dtype])</p></td>
<td><p>Pooling operator.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Continuous-Domain Sampling Operators</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.sampling.NNSampling" title="pycsou.linop.sampling.NNSampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NNSampling</span></code></a>(samples, grid[, dtype])</p></td>
<td><p>Nearest neighbours sampling operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.sampling.GeneralisedVandermonde" title="pycsou.linop.sampling.GeneralisedVandermonde"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralisedVandermonde</span></code></a>(samples, funcs[, dtype])</p></td>
<td><p>Generalised Vandermonde matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.sampling.MappedDistanceMatrix" title="pycsou.linop.sampling.MappedDistanceMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MappedDistanceMatrix</span></code></a>(samples1, function[, …])</p></td>
<td><p>Transformed Distance Matrix.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pycsou.linop.sampling.SubSampling">
<code class="sig-name descname">SubSampling</code><span class="sig-paren">(</span><em class="sig-param">size: int, sampling_indices: Union[numpy.ndarray, list], shape: Optional[tuple] = None, axis: int = 0, dtype: str = 'float64', inplace: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#SubSampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.SubSampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Subsampling operator.</p>
<p>Extract subset of values from input array at locations <code class="docutils literal notranslate"><span class="pre">sampling_indices</span></code>
in forward mode and place those values at locations <code class="docutils literal notranslate"><span class="pre">sampling_indices</span></code>
in an otherwise zero array in adjoint mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of input array.</p></li>
<li><p><strong>sampling_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Integer indices of samples for data selection.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of input array
(<code class="docutils literal notranslate"><span class="pre">None</span></code> if only one dimension is available).</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – When <code class="docutils literal notranslate"><span class="pre">shape</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, axis along which subsampling is applied.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input array.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Work inplace (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or make a new copy (<code class="docutils literal notranslate"><span class="pre">False</span></code>). By default,
data is a reference to the model (in forward) and model is a reference
to the data (in adjoint).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The subsampling operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.PyLopLinearOperator" title="pycsou.linop.base.PyLopLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyLopLinearOperator</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If shape and size do not match.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling_indices</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span><span class="o">=</span><span class="n">SubSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">sampling_indices</span><span class="o">=</span><span class="n">sampling_indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([0, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">SamplingOp</span><span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[0., 0., 2.],</span>
<span class="go">       [0., 0., 0.],</span>
<span class="go">       [0., 0., 0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span><span class="o">=</span><span class="n">SubSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">sampling_indices</span><span class="o">=</span><span class="n">sampling_indices</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">SamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">sampling_indices</span><span class="p">))</span>
<span class="go">array([[0, 2],</span>
<span class="go">       [3, 5],</span>
<span class="go">       [6, 8]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">SamplingOp</span><span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[0., 0., 2.],</span>
<span class="go">       [3., 0., 5.],</span>
<span class="go">       [6., 0., 8.]])</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>Subsampling of a subset of <span class="math notranslate nohighlight">\(L\)</span> values at locations
<code class="docutils literal notranslate"><span class="pre">sampling_indices</span></code> from an input vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> of size
<span class="math notranslate nohighlight">\(N\)</span> can be expressed as:</p>
<div class="math notranslate nohighlight">
\[y_i = x_{n_i}  \quad \forall i=1,2,...,L,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{n}=[n_1, n_2,..., n_L]\)</span> is a vector containing the indeces
of the original array at which samples are taken.</p>
<p>Conversely, in adjoint mode the available values in the data vector
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> are placed at locations
<span class="math notranslate nohighlight">\(\mathbf{n}=[n_1, n_2,..., n_L]\)</span> in the model vector:</p>
<div class="math notranslate nohighlight">
\[x_{n_i} = y_i  \quad \forall i=1,2,...,L\]</div>
<p>and <span class="math notranslate nohighlight">\(x_{j}=0 \,\forall j \neq n_i\)</span> (i.e., at all other locations in input
vector).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.Masking" title="pycsou.linop.sampling.Masking"><code class="xref py py-class docutils literal notranslate"><span class="pre">Masking</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Downsampling</span></code></p>
</div>
</dd></dl>

<dl class="class">
<dt id="pycsou.linop.sampling.Masking">
<em class="property">class </em><code class="sig-name descname">Masking</code><span class="sig-paren">(</span><em class="sig-param">size: int, sampling_bool: Union[numpy.ndarray, list], dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Masking"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Masking" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Masking operator.</p>
<p>Extract subset of values from input array at locations marked as <code class="docutils literal notranslate"><span class="pre">True</span></code> in <code class="docutils literal notranslate"><span class="pre">sampling_bool</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling_bool</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling_bool</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span> <span class="o">=</span> <span class="n">Masking</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">sampling_bool</span><span class="o">=</span><span class="n">sampling_bool</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([3, 8])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">SamplingOp</span><span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[0., 0., 0.],</span>
<span class="go">       [3., 0., 0.],</span>
<span class="go">       [0., 0., 8.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampling_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">sampling_bool</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SubSamplingOp</span><span class="o">=</span><span class="n">SubSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">sampling_indices</span><span class="o">=</span><span class="n">sampling_indices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">SamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">SubSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>For flattened arrays, the <code class="docutils literal notranslate"><span class="pre">Masking</span></code> operator is equivalent to the <a class="reference internal" href="#pycsou.linop.sampling.SubSampling" title="pycsou.linop.sampling.SubSampling"><code class="xref py py-func docutils literal notranslate"><span class="pre">SubSampling()</span></code></a> operator,
with the only difference that the sampling locations are specified in the form of a boolean array instead of indices.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.SubSampling" title="pycsou.linop.sampling.SubSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubSampling</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Downsampling</span></code></p>
</div>
<dl class="method">
<dt id="pycsou.linop.sampling.Masking.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">size: int, sampling_bool: Union[numpy.ndarray, list], dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Masking.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Masking.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of input array.</p></li>
<li><p><strong>sampling_bool</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Boolean array for data selection. <code class="docutils literal notranslate"><span class="pre">True</span></code> values mark the positions of the samples.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – </p></li>
<li><p><strong>of elements in input array.</strong> (<em>Type</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the size of <code class="docutils literal notranslate"><span class="pre">sampling_bool</span></code> differs from <code class="docutils literal notranslate"><span class="pre">size</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.Masking.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Masking.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Masking.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.linop.sampling.DownSampling">
<em class="property">class </em><code class="sig-name descname">DownSampling</code><span class="sig-paren">(</span><em class="sig-param">size: int, downsampling_factor: Union[int, tuple, list], shape: Optional[tuple] = None, axis: Optional[int] = None, dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#DownSampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.DownSampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycsou.linop.sampling.Masking" title="pycsou.linop.sampling.Masking"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.linop.sampling.Masking</span></code></a></p>
<p>Downsampling operator.</p>
<p>Downsample an array in one of the three ways:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>: The input array is flat and the downsampling selects one element every
<code class="docutils literal notranslate"><span class="pre">downsampling_factor</span></code> elements.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>: The input array is multidimensional, and each dimension is
downsampled by a certain factor. Downsampling factors for each dimension are specified in the tuple
<code class="docutils literal notranslate"><span class="pre">downsampling_factor</span></code> (if <code class="docutils literal notranslate"><span class="pre">downsampling_factor</span></code> is an integer, then the same factor is assumed for every dimension).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">shape</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">axis</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>: The input array is multidimensional, but only the dimension is
specified by <code class="docutils literal notranslate"><span class="pre">axis</span></code> is downsampled by a <code class="docutils literal notranslate"><span class="pre">downsampling_factor</span></code>.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span>
<span class="go">array([0, 3, 6, 9])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="go">array([0., 0., 0., 3., 0., 0., 6., 0., 0., 9.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">DownSamplingOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="go">array([[ 0,  3],</span>
<span class="go">       [15, 18]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">DownSamplingOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="go">array([[ 0,  4],</span>
<span class="go">       [10, 14]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  4.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [10.,  0.,  0.,  0., 14.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">DownSamplingOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="go">array([[ 0,  2,  4],</span>
<span class="go">       [ 5,  7,  9],</span>
<span class="go">       [10, 12, 14],</span>
<span class="go">       [15, 17, 19]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DownSamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">DownSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  2.,  0.,  4.],</span>
<span class="go">       [ 5.,  0.,  7.,  0.,  9.],</span>
<span class="go">       [10.,  0., 12.,  0., 14.],</span>
<span class="go">       [15.,  0., 17.,  0., 19.]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.sampling</span> <span class="kn">import</span> <span class="n">DownSampling</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.misc</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">DownSampOp</span> <span class="o">=</span> <span class="n">DownSampling</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">downsampling_factor</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">down_sampled_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">DownSampOp</span> <span class="o">*</span> <span class="n">img</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">DownSampOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="n">up_sampled_img</span> <span class="o">=</span> <span class="n">DownSampOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">down_sampled_img</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">down_sampled_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Downsampling&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">up_sampled_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Downsampling followed by Upsampling&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../operators/pycsou-linop-sampling-1.py">Source code</a>)</p>
<div class="figure align-default" id="id2">
<img alt="../_images/pycsou-linop-sampling-1_00.png" src="../_images/pycsou-linop-sampling-1_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-1_00.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-1_00.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-1_00.pdf">pdf</a>)</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id3">
<img alt="../_images/pycsou-linop-sampling-1_01.png" src="../_images/pycsou-linop-sampling-1_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-1_01.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-1_01.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-1_01.pdf">pdf</a>)</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id4">
<img alt="../_images/pycsou-linop-sampling-1_02.png" src="../_images/pycsou-linop-sampling-1_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-1_02.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-1_02.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-1_02.pdf">pdf</a>)</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Downsampling by <span class="math notranslate nohighlight">\(M\)</span> an input vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> of size
<span class="math notranslate nohighlight">\(N\)</span> can be performed as:</p>
<div class="math notranslate nohighlight">
\[y_i = x_{iM}  \quad  i=1,\ldots, \lfloor N/M \rfloor.\]</div>
<p>Conversely, in adjoint mode the available values in the data vector
<span class="math notranslate nohighlight">\(\mathbf{y}\)</span> are placed at locations
<span class="math notranslate nohighlight">\(n=iM\)</span> in the model vector:</p>
<div class="math notranslate nohighlight">
\[x_{iM} = y_i,\;\;x_{iM+1}=x_{iM+2}=\cdots=x_{(i+1)M-1}=0, \qquad i=1,\ldots, \lfloor N/M \rfloor.\]</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.SubSampling" title="pycsou.linop.sampling.SubSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubSampling</span></code></a>, <a class="reference internal" href="#pycsou.linop.sampling.Masking" title="pycsou.linop.sampling.Masking"><code class="xref py py-class docutils literal notranslate"><span class="pre">Masking</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.linop.sampling.DownSampling.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">size: int, downsampling_factor: Union[int, tuple, list], shape: Optional[tuple] = None, axis: Optional[int] = None, dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#DownSampling.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.DownSampling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of input array.</p></li>
<li><p><strong>downsampling_factor</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>]</em>) – Downsampling factor (possibly different for each dimension).</p></li>
<li><p><strong>shape</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>]</em>) – Shape of input array (default <code class="docutils literal notranslate"><span class="pre">None</span></code>: the input array is 1D).</p></li>
<li><p><strong>axis</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>]</em>) – Axis along which to downsample for ND input arrays (default <code class="docutils literal notranslate"><span class="pre">None</span></code>: downsampling is performed along each axis).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of input array.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the set of parameters {<code class="docutils literal notranslate"><span class="pre">shape</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">sampling_factor</span></code>, <code class="docutils literal notranslate"><span class="pre">axis</span></code>} is invalid.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.DownSampling.compute_downsampling_mask">
<code class="sig-name descname">compute_downsampling_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#DownSampling.compute_downsampling_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.DownSampling.compute_downsampling_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the downsampling mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mask to apply to get the downsampled values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.linop.sampling.Pooling">
<em class="property">class </em><code class="sig-name descname">Pooling</code><span class="sig-paren">(</span><em class="sig-param">shape: tuple, block_size: Union[tuple, list], pooling_func: str = 'mean', dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Pooling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Pooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Pooling operator.</p>
<p>Pool an array by summing/averaging across constant size blocks tiling the array.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PoolingOp</span> <span class="o">=</span> <span class="n">Pooling</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">pooling_func</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">PoolingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">PoolingOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="go">array([[ 4.,  7.],</span>
<span class="go">       [16., 19.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PoolingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">PoolingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[ 4.,  4.,  4.,  7.,  7.,  7.],</span>
<span class="go">       [ 4.,  4.,  4.,  7.,  7.,  7.],</span>
<span class="go">       [16., 16., 16., 19., 19., 19.],</span>
<span class="go">       [16., 16., 16., 19., 19., 19.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PoolingOp</span> <span class="o">=</span> <span class="n">Pooling</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">pooling_func</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">PoolingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">PoolingOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="go">array([[ 24,  42],</span>
<span class="go">       [ 96, 114]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PoolingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">PoolingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[ 24,  24,  24,  42,  42,  42],</span>
<span class="go">       [ 24,  24,  24,  42,  42,  42],</span>
<span class="go">       [ 96,  96,  96, 114, 114, 114],</span>
<span class="go">       [ 96,  96,  96, 114, 114, 114]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.sampling</span> <span class="kn">import</span> <span class="n">Pooling</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.misc</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">face</span><span class="p">(</span><span class="n">gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">PoolingOp</span> <span class="o">=</span> <span class="n">Pooling</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">block_size</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">pooled_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">PoolingOp</span> <span class="o">*</span> <span class="n">img</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">PoolingOp</span><span class="o">.</span><span class="n">output_shape</span><span class="p">)</span>
<span class="n">adjoint_img</span> <span class="o">=</span> <span class="n">PoolingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">pooled_img</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">pooled_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean Pooling&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">adjoint_img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Mean Pooling followed by Unpooling&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../operators/pycsou-linop-sampling-2.py">Source code</a>)</p>
<div class="figure align-default" id="id5">
<img alt="../_images/pycsou-linop-sampling-2_00.png" src="../_images/pycsou-linop-sampling-2_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-2_00.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-2_00.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-2_00.pdf">pdf</a>)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id6">
<img alt="../_images/pycsou-linop-sampling-2_01.png" src="../_images/pycsou-linop-sampling-2_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-2_01.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-2_01.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-2_01.pdf">pdf</a>)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<img alt="../_images/pycsou-linop-sampling-2_02.png" src="../_images/pycsou-linop-sampling-2_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-2_02.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-2_02.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-2_02.pdf">pdf</a>)</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Pooling is performed via the function <a class="reference external" href="https://scikit-image.org/docs/dev/api/skimage.measure.html#skimage.measure.block_reduce">skimage.measure.block_reduce</a>
from <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code>. If one dimension of the image is not perfectly divisible by the block size then it is zero padded.</p>
<p>The adjoint (<em>unpooling</em>) is performed by assigning the value of the blocks through the pooling function (e.g. mean, sum) to each element
of the blocks.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Max, median or min pooling are not supported since the resulting <cite>PoolingOperator</cite> would then be non linear!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.SubSampling" title="pycsou.linop.sampling.SubSampling"><code class="xref py py-class docutils literal notranslate"><span class="pre">SubSampling</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Downsampling</span></code></p>
</div>
<dl class="method">
<dt id="pycsou.linop.sampling.Pooling.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">shape: tuple, block_size: Union[tuple, list], pooling_func: str = 'mean', dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Pooling.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Pooling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>block_size</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>]</em>) – Shape of the sub-blocks on which pooling is performed.</p></li>
<li><p><strong>pooling_func</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Specifies if the local blocks should be summed (<cite>pooling_func=’sum’</cite>) or averaged (<cite>pooling_func=’mean’</cite>).</p></li>
<li><p><strong>dtype</strong> – Type of input array.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the block size is inconsistent with the input array shape or if the pooling function is not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.Pooling.get_output_shape">
<code class="sig-name descname">get_output_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Pooling.get_output_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Pooling.get_output_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shape of the pooled array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Output array shape.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.Pooling.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#Pooling.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.Pooling.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.linop.sampling.NNSampling">
<em class="property">class </em><code class="sig-name descname">NNSampling</code><span class="sig-paren">(</span><em class="sig-param">samples: numpy.ndarray</em>, <em class="sig-param">grid: numpy.ndarray</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#NNSampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.NNSampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Nearest neighbours sampling operator.</p>
<p>Sample a gridded ND signal at on-grid nearest neighbours of off-grid sampling locations. This can be useful when piecewise
constant priors are used to recover continuously-defined signals sampled non-uniformly (see <a class="reference internal" href="../notes/references.html#funcsphere" id="id1"><span>[FuncSphere]</span></a> Remark 6.9).</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="mi">5</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span><span class="mi">3</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="go">[[3.18480844 1.81990733]</span>
<span class="go"> [1.34893357 2.18848968]</span>
<span class="go"> [0.20486762 1.63087497]</span>
<span class="go"> [0.08263818 2.80521727]</span>
<span class="go"> [4.0663512  2.44756066]</span>
<span class="go"> [4.56377789 0.0082155 ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NNSamplingOp</span> <span class="o">=</span> <span class="n">NNSampling</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">NNSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">array([15, 13, 12, 18, 16,  5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NNSamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">NNSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  0.,  5.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [12., 13.,  0., 15., 16.,  0.],</span>
<span class="go">       [18.,  0.,  0.,  0.,  0.,  0.]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.sampling</span> <span class="kn">import</span> <span class="n">NNSampling</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="mi">5</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">NNSamplingOp</span> <span class="o">=</span> <span class="n">NNSampling</span><span class="p">(</span><span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">NNSamplingOp</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">x_samp</span> <span class="o">=</span> <span class="n">NNSamplingOp</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
     <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">grid</span><span class="p">[</span><span class="n">NNSamplingOp</span><span class="o">.</span><span class="n">nn_indices</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
  <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">grid</span><span class="p">[</span><span class="n">NNSamplingOp</span><span class="o">.</span><span class="n">nn_indices</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;--r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Nearest-neighbours Sampling&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">grid</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">x_samp</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span>
     <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
     <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">grid</span><span class="p">[</span><span class="n">NNSamplingOp</span><span class="o">.</span><span class="n">nn_indices</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
  <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">grid</span><span class="p">[</span><span class="n">NNSamplingOp</span><span class="o">.</span><span class="n">nn_indices</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">samples</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="s1">&#39;--r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sampling followed by adjoint&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../operators/pycsou-linop-sampling-3.py">Source code</a>)</p>
<div class="figure align-default" id="id8">
<img alt="../_images/pycsou-linop-sampling-3_00.png" src="../_images/pycsou-linop-sampling-3_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-3_00.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-3_00.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-3_00.pdf">pdf</a>)</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id9">
<img alt="../_images/pycsou-linop-sampling-3_01.png" src="../_images/pycsou-linop-sampling-3_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../operators/pycsou-linop-sampling-3_01.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-3_01.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-3_01.pdf">pdf</a>)</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Consider a signal defined over a mesh <span class="math notranslate nohighlight">\(f:\{\mathbf{n}_1,\ldots, \mathbf{n}_M\}\to \mathbb{C}\)</span>, with
<span class="math notranslate nohighlight">\(\{\mathbf{n}_1,\ldots, \mathbf{n}_M\}\subset \mathbb{R}^N\)</span>. Consider moreover sampling locations
<span class="math notranslate nohighlight">\(\{\mathbf{z}_1,\ldots, \mathbf{z}_L\}\subset \mathbb{R}^N\)</span> which do not necessarily lie on the mesh.
Then, nearest-neighbours sampling is defined as:</p>
<div class="math notranslate nohighlight">
\[y_i=f\left[\arg\min_{k=1,\ldots, M}\|\mathbf{z}_i-\mathbf{n}_k\|_2\right], \qquad i=1,\ldots, L.\]</div>
<p>Note that in practice every sample locations has exactly <em>one</em> nearest neighbour (ties have probability zero) and hence
this equation is well-defined.</p>
<p>Given a vector <span class="math notranslate nohighlight">\(\mathbf{y}=[y_1,\ldots, y_L]\in\mathbb{C}^N\)</span>, the adjoint of the <code class="docutils literal notranslate"><span class="pre">NNSampling</span></code> operator is defined as</p>
<div class="math notranslate nohighlight">
\[f[\mathbf{n}_k]=\mbox{mean}\left\{y_i :\; \mathbf{n}_k=\arg\min_{j=1,\ldots,M}\|\mathbf{z}_i-\mathbf{n}_j\|_2,\, i=1,\ldots, L\right\},\quad k=1,\ldots, M,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mbox{mean}\{B\}=|B|^{-1}\sum_{z\in B} z,\; \forall B\subset\mathbb{C}\)</span> and with the convention that <span class="math notranslate nohighlight">\(\mbox{mean}\{\emptyset\}=0.\)</span>
The mean is used to handle cases where many sampling locations are mapped to a common nearest neighbour on the mesh.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The grid needs not be uniform! Think of it as a mesh. It can happen that more than one sampling location is mapped to
the same nearest neighbour.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.GeneralisedVandermonde" title="pycsou.linop.sampling.GeneralisedVandermonde"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralisedVandermonde</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.linop.sampling.NNSampling.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">samples: numpy.ndarray</em>, <em class="sig-param">grid: numpy.ndarray</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#NNSampling.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.NNSampling.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em>) – Off-grid sampling locations with shape (M,N).</p></li>
<li><p><strong>grid</strong> – Grid points with shape (L,N).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the input array.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If the dimension of the sample locations and the grid points do not match.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.NNSampling.compute_nn">
<code class="sig-name descname">compute_nn</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#NNSampling.compute_nn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.NNSampling.compute_nn" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the on-grid nearest neighbours to the sampling locations.</p>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.NNSampling.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#NNSampling.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.NNSampling.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.linop.sampling.GeneralisedVandermonde">
<em class="property">class </em><code class="sig-name descname">GeneralisedVandermonde</code><span class="sig-paren">(</span><em class="sig-param">samples: numpy.ndarray, funcs: List[Callable], dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#GeneralisedVandermonde"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.GeneralisedVandermonde" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.DenseLinearOperator" title="pycsou.linop.base.DenseLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.linop.base.DenseLinearOperator</span></code></a></p>
<p>Generalised Vandermonde matrix.</p>
<p>Given sampling locations <span class="math notranslate nohighlight">\(\{\mathbf{z}_1,\ldots,\mathbf{z}_L\}\subset\mathbb{R}^N\)</span>, and a family of <cite>continuous</cite> functions <span class="math notranslate nohighlight">\(\{\varphi_1, \ldots, \varphi_K\}\subset \mathcal{C}(\mathbb{R}^N, \mathbb{C})\)</span>,
this function forms the generalised Vandermonde matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{ccc} \varphi_1(\mathbf{z}_1) &amp; \cdots &amp; \varphi_K(\mathbf{z}_1)\\\vdots &amp; \ddots &amp; \vdots\\\varphi_1(\mathbf{z}_L) &amp; \cdots &amp; \varphi_K(\mathbf{z}_L)\end{array}\right]\in\mathbb{C}^{L\times K}.\end{split}\]</div>
<p>This matrix is useful for sampling functions in the span of <span class="math notranslate nohighlight">\(\{\varphi_1, \ldots, \varphi_K\}\)</span>. Indeed, if <span class="math notranslate nohighlight">\(f=\sum_{k=1}^K\alpha_k\varphi_k\)</span>, then we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{c}f(\mathbf{z}_1)\\\vdots\\ f(\mathbf{z}_L) \end{array}\right]=\left[\begin{array}{ccc} \varphi_1(\mathbf{z}_1) &amp; \cdots &amp; \varphi_K(\mathbf{z}_1)\\\vdots &amp; \ddots &amp; \vdots\\\varphi_1(\mathbf{z}_L) &amp; \cdots &amp; \varphi_K(\mathbf{z}_L)\end{array}\right]\left[\begin{array}{c}\alpha_1\\\vdots\\ \alpha_K \end{array}\right].\end{split}\]</div>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func1</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span><span class="p">;</span>  <span class="n">func2</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="p">;</span> <span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="n">func1</span><span class="p">,</span> <span class="n">func2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">VOp</span> <span class="o">=</span> <span class="n">GeneralisedVandermonde</span><span class="p">(</span><span class="n">funcs</span><span class="o">=</span><span class="n">funcs</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="n">samples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">VOp</span><span class="o">.</span><span class="n">mat</span>
<span class="go">array([[  0.,   0.],</span>
<span class="go">       [  1.,   1.],</span>
<span class="go">       [  4.,   8.],</span>
<span class="go">       [  9.,  27.],</span>
<span class="go">       [ 16.,  64.],</span>
<span class="go">       [ 25., 125.],</span>
<span class="go">       [ 36., 216.],</span>
<span class="go">       [ 49., 343.],</span>
<span class="go">       [ 64., 512.],</span>
<span class="go">       [ 81., 729.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">VOp</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">samples</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">samples</span> <span class="o">**</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.MappedDistanceMatrix" title="pycsou.linop.sampling.MappedDistanceMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">MappedDistanceMatrix</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.linop.sampling.GeneralisedVandermonde.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">samples: numpy.ndarray, funcs: List[Callable], dtype: type = &lt;class 'numpy.float64'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#GeneralisedVandermonde.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.GeneralisedVandermonde.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<em>np.ndarray</em>) – Sampling locations with shape (L,N).</p></li>
<li><p><strong>funcs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of functions.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of input array.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.GeneralisedVandermonde.get_generalised_vandermonde_matrix">
<code class="sig-name descname">get_generalised_vandermonde_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#GeneralisedVandermonde.get_generalised_vandermonde_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.GeneralisedVandermonde.get_generalised_vandermonde_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the generalised Vandermonde matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The generalised Vandermonde matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.linop.sampling.MappedDistanceMatrix">
<em class="property">class </em><code class="sig-name descname">MappedDistanceMatrix</code><span class="sig-paren">(</span><em class="sig-param">samples1: numpy.ndarray</em>, <em class="sig-param">function: Callable</em>, <em class="sig-param">samples2: Optional[numpy.ndarray] = None</em>, <em class="sig-param">mode: str = 'radial'</em>, <em class="sig-param">max_distance: Optional[float] = None</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">chunks: Union[str</em>, <em class="sig-param">int</em>, <em class="sig-param">tuple</em>, <em class="sig-param">None] = 'auto'</em>, <em class="sig-param">operator_type: str = 'dask'</em>, <em class="sig-param">verbose: bool = True</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">joblib_backend: str = 'loky'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#MappedDistanceMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.MappedDistanceMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.ExplicitLinearOperator" title="pycsou.linop.base.ExplicitLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.linop.base.ExplicitLinearOperator</span></code></a></p>
<p>Transformed Distance Matrix.</p>
<p>Given two point sets <span class="math notranslate nohighlight">\(\{\mathbf{z}_1,\ldots,\mathbf{z}_L\}\subset\mathbb{R}^N\)</span>, <span class="math notranslate nohighlight">\(\{\mathbf{x}_1,\ldots,\mathbf{x}_K\}\subset\mathbb{R}^N\)</span>
and a <cite>continuous</cite> function <span class="math notranslate nohighlight">\(\varphi:\mathbb{R}_+\to\mathbb{C}\)</span>, this function forms the following matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{ccc} \varphi(d(\mathbf{z}_1,\mathbf{x}_1)) &amp; \cdots &amp; \varphi(d(\mathbf{z}_1,\mathbf{x}_K))\\\vdots &amp; \ddots &amp; \vdots\\\varphi(d(\mathbf{z}_L,\mathbf{x}_1)) &amp; \cdots &amp; \varphi(d(\mathbf{z}_1,\mathbf{x}_K))\end{array}\right]\in\mathbb{C}^{L\times K},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d:\mathbb{R}^N\times \mathbb{R}^N\to \mathbb{R}_+\)</span> is a distance defined in one of the following two ways:</p>
<ul class="simple">
<li><p><cite>Radial:</cite> <span class="math notranslate nohighlight">\(d(\mathbf{z},\mathbf{x}))=\|\mathbf{z}-\mathbf{x}\|_2, \; \forall \mathbf{z},\mathbf{x}\in\mathbb{R}^N,\)</span></p></li>
<li><p><cite>Zonal:</cite> <span class="math notranslate nohighlight">\(d(\mathbf{z},\mathbf{x}))=\sqrt{2-2\langle\mathbf{z},\mathbf{x}\rangle}, \; \forall \mathbf{z},\mathbf{x}\in\mathbb{S}^{N-1}.\)</span>
Note that in this case the two point sets must be on the hypersphere <span class="math notranslate nohighlight">\(\mathbb{S}^{N-1}.\)</span></p></li>
</ul>
<p>This matrix is useful for sampling sums of radial/zonal functions. Indeed, if <span class="math notranslate nohighlight">\(f(\mathbf{z})=\sum_{k=1}^K\alpha_k\varphi(d(\mathbf{z},\mathbf{x}_k))\)</span>, then we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{c}f(\mathbf{z}_1)\\\vdots\\ f(\mathbf{z}_L) \end{array}\right]=\left[\begin{array}{ccc} \varphi(d(\mathbf{z}_1,\mathbf{x}_1)) &amp; \cdots &amp; \varphi(d(\mathbf{z}_1,\mathbf{x}_K))\\\vdots &amp; \ddots &amp; \vdots\\\varphi(d(\mathbf{z}_L,\mathbf{x}_1)) &amp; \cdots &amp; \varphi(d(\mathbf{z}_1,\mathbf{x}_K))\end{array}\right]\left[\begin{array}{c}\alpha_1\\\vdots\\ \alpha_K \end{array}\right].\end{split}\]</div>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_distance</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">sigma</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">samples1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">samples2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp1</span> <span class="o">=</span> <span class="n">MappedDistanceMatrix</span><span class="p">(</span><span class="n">samples1</span><span class="o">=</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="o">=</span><span class="n">samples2</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">func</span><span class="p">,</span><span class="n">max_distance</span><span class="o">=</span><span class="n">max_distance</span><span class="p">,</span> <span class="n">operator_type</span><span class="o">=</span><span class="s1">&#39;sparse&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp2</span> <span class="o">=</span> <span class="n">MappedDistanceMatrix</span><span class="p">(</span><span class="n">samples1</span><span class="o">=</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">func</span><span class="p">,</span><span class="n">max_distance</span><span class="o">=</span><span class="n">max_distance</span><span class="p">,</span> <span class="n">operator_type</span><span class="o">=</span><span class="s1">&#39;sparse&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp3</span> <span class="o">=</span> <span class="n">MappedDistanceMatrix</span><span class="p">(</span><span class="n">samples1</span><span class="o">=</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="o">=</span><span class="n">samples2</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">operator_type</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp4</span> <span class="o">=</span> <span class="n">MappedDistanceMatrix</span><span class="p">(</span><span class="n">samples1</span><span class="o">=</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="o">=</span><span class="n">samples2</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">operator_type</span><span class="o">=</span><span class="s1">&#39;dask&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">MDMOp1</span><span class="o">.</span><span class="n">mat</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">MDMOp3</span><span class="o">.</span><span class="n">mat</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">MDMOp4</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
<span class="go">(&lt;class &#39;scipy.sparse.csr.csr_matrix&#39;&gt;, &lt;class &#39;numpy.ndarray&#39;&gt;, &lt;class &#39;dask.array.core.Array&#39;&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp1</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">MDMOp2</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">shape</span>
<span class="go">((10, 3), (10, 10))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp3</span><span class="o">.</span><span class="n">mat</span>
<span class="go">array([[6.43689834e-009, 5.64922608e-029, 2.23956473e-001],</span>
<span class="go">       [2.38517543e-003, 2.61112241e-017, 6.44840995e-001],</span>
<span class="go">       [7.21186665e-001, 9.84802612e-009, 1.51504434e-003],</span>
<span class="go">       [1.77933914e-001, 3.03078296e-003, 2.90456923e-009],</span>
<span class="go">       [3.58222996e-005, 7.61104282e-001, 4.54382719e-018],</span>
<span class="go">       [5.88480228e-012, 1.55961419e-001, 5.80023464e-030],</span>
<span class="go">       [7.88849171e-022, 2.60779757e-005, 6.04161441e-045],</span>
<span class="go">       [8.62858845e-035, 3.55806811e-012, 5.13504354e-063],</span>
<span class="go">       [7.70139186e-051, 3.96130538e-022, 3.56138512e-084],</span>
<span class="go">       [5.60896038e-070, 3.59870356e-035, 2.01547509e-108]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">samples2</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beta</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">samples1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp1</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="go">array([0.27995783, 0.8060865 , 0.37589858, 0.09274313, 1.19684992,</span>
<span class="go">       0.24525208, 0.        , 0.        , 0.        , 0.        ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp2</span> <span class="o">*</span> <span class="n">beta</span>
<span class="go">array([0.80274037, 1.39329178, 1.27124579, 1.22168244, 1.08494933,</span>
<span class="go">       1.36310926, 0.7558366 , 0.96398702, 0.85066284, 1.37152693])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp3</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="go">array([2.79957838e-01, 8.07329704e-01, 3.77792488e-01, 9.75090904e-02,</span>
<span class="go">       1.19686859e+00, 2.45252084e-01, 4.10080770e-05, 5.59512490e-12,</span>
<span class="go">       6.22922262e-22, 5.65902486e-35])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDMOp4</span> <span class="o">*</span> <span class="n">alpha</span>
<span class="go">array([2.79957838e-01, 8.07329704e-01, 3.77792488e-01, 9.75090904e-02,</span>
<span class="go">       1.19686859e+00, 2.45252084e-01, 4.10080770e-05, 5.59512490e-12,</span>
<span class="go">       6.22922262e-22, 5.65902486e-35])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">MDMOp3</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">MDMOp4</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.sampling</span> <span class="kn">import</span> <span class="n">MappedDistanceMatrix</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">samples1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">samples2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">samples2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">12</span>
<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">MDMOp</span> <span class="o">=</span> <span class="n">MappedDistanceMatrix</span><span class="p">(</span><span class="n">samples1</span><span class="o">=</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="o">=</span><span class="n">samples2</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">operator_type</span><span class="o">=</span><span class="s1">&#39;dask&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,(</span><span class="n">MDMOp</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sum of 4 (radial) Gaussians&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$y$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../operators/pycsou-linop-sampling-4.py">Source code</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-4.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-4.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-4.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/pycsou-linop-sampling-4.png" src="../_images/pycsou-linop-sampling-4.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.sampling</span> <span class="kn">import</span> <span class="n">MappedDistanceMatrix</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">phi</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">samples1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">phi2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">theta2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span>
<span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">)</span>
<span class="n">samples2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">samples2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">9</span>
<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">MDMOp</span> <span class="o">=</span> <span class="n">MappedDistanceMatrix</span><span class="p">(</span><span class="n">samples1</span><span class="o">=</span><span class="n">samples1</span><span class="p">,</span> <span class="n">samples2</span><span class="o">=</span><span class="n">samples2</span><span class="p">,</span> <span class="n">function</span><span class="o">=</span><span class="n">func</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;zonal&#39;</span><span class="p">,</span> <span class="n">operator_type</span><span class="o">=</span><span class="s1">&#39;sparse&#39;</span><span class="p">,</span> <span class="n">max_distance</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">sigma</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="p">(</span><span class="n">MDMOp</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sum of 4 (zonal) wrapped Gaussians&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">phi$ (radians)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">theta$ (radians)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../operators/pycsou-linop-sampling-5.py">Source code</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-5.png">png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-5.hires.png">hires.png</a>, <a class="reference external" href="../operators/pycsou-linop-sampling-5.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/pycsou-linop-sampling-5.png" src="../_images/pycsou-linop-sampling-5.png" />
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.sampling.GeneralisedVandermonde" title="pycsou.linop.sampling.GeneralisedVandermonde"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralisedVandermonde</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.linop.sampling.MappedDistanceMatrix.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">samples1: numpy.ndarray</em>, <em class="sig-param">function: Callable</em>, <em class="sig-param">samples2: Optional[numpy.ndarray] = None</em>, <em class="sig-param">mode: str = 'radial'</em>, <em class="sig-param">max_distance: Optional[float] = None</em>, <em class="sig-param">dtype: type = &lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">chunks: Union[str</em>, <em class="sig-param">int</em>, <em class="sig-param">tuple</em>, <em class="sig-param">None] = 'auto'</em>, <em class="sig-param">operator_type: str = 'dask'</em>, <em class="sig-param">verbose: bool = True</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">joblib_backend: str = 'loky'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pycsou/linop/sampling.html#MappedDistanceMatrix.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.MappedDistanceMatrix.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples1</strong> (<em>np.ndarray</em>) – First point set with shape (L,N).</p></li>
<li><p><strong>function</strong> (<em>Callable</em>) – Function <span class="math notranslate nohighlight">\(\varphi: \mathbb{R}_+\to \mathbb{C}\)</span> to apply to each entry of the distance matrix.</p></li>
<li><p><strong>samples2</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Optional second point set with shape (K,N). If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">samples2</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">samples1</span></code> and the operator symmetric.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – How to compute the distances. If <code class="docutils literal notranslate"><span class="pre">'radial'</span></code>, the Euclidean distance is used. If <code class="docutils literal notranslate"><span class="pre">'zonal'</span></code> the spherical geodesic distance is used.</p></li>
<li><p><strong>max_distance</strong> (<em>Optional</em><em>[</em><em>np.float</em><em>]</em>) – Support of the function <span class="math notranslate nohighlight">\(\varphi\)</span>. Must be specified for sparse representation.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of input array.</p></li>
<li><p><strong>chunks</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a><em>]</em>) – Chunk sizes for Dask representation.</p></li>
<li><p><strong>operator_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Internal representation of the operator: <code class="docutils literal notranslate"><span class="pre">'dense'</span></code> represents the operator as a Numpy array, <code class="docutils literal notranslate"><span class="pre">'dask'</span></code> as a <a class="reference external" href="https://docs.dask.org/en/latest/array.html">Dask array</a>,
<code class="docutils literal notranslate"><span class="pre">'sparse'</span></code> as a <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/sparse.html">sparse matrix</a>. Dask arrays or sparse matrices can be more memory efficient for very large point sets.</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Verbosity for parallel computations (only for sparse representations).</p></li>
<li><p><strong>n_jobs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Number of cores for parallel computations (only for sparse representations). <code class="docutils literal notranslate"><span class="pre">n_jobs=-1</span></code> uses all available cores.</p></li>
<li><p><strong>joblib_backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Joblib backend (<a class="reference external" href="https://joblib.readthedocs.io/en/latest/generated/joblib.Parallel.html">more details here</a>).</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">mode</span></code> is invalid or if <code class="docutils literal notranslate"><span class="pre">operator_type</span></code> is <code class="docutils literal notranslate"><span class="pre">'sparse'</span></code> but <code class="docutils literal notranslate"><span class="pre">max_distance=None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.MappedDistanceMatrix.get_sparse_mdm">
<code class="sig-name descname">get_sparse_mdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; scipy.sparse.csr.csr_matrix<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#MappedDistanceMatrix.get_sparse_mdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.MappedDistanceMatrix.get_sparse_mdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the Mapped Distance Matrix as a sparse matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sparse Mapped Distance Matrix.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>sparse.csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.MappedDistanceMatrix.get_dask_mdm">
<code class="sig-name descname">get_dask_mdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dask.array.core.Array<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#MappedDistanceMatrix.get_dask_mdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.MappedDistanceMatrix.get_dask_mdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the Mapped Distance Matrix as a dask array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mapped Distance Matrix as a Dask array.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>da.core.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.sampling.MappedDistanceMatrix.get_dense_mdm">
<code class="sig-name descname">get_dense_mdm</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/pycsou/linop/sampling.html#MappedDistanceMatrix.get_dense_mdm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.sampling.MappedDistanceMatrix.get_dense_mdm" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the Mapped Distance Matrix as a dense Numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Mapped Distance Matrix as a Numpy array.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../functionals/index.html" class="btn btn-neutral float-right" title="Cost Functionals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pycsou.linop.diff.html" class="btn btn-neutral float-left" title="Differential Operators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Matthieu SIMEONI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>