

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Differential Operators &mdash; pycsou 1.0.1.dev11 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sampling Operators" href="pycsou.linop.sampling.html" />
    <link rel="prev" title="Convolution Operators" href="pycsou.linop.conv.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pycsou
          

          
          </a>

          
            
            
              <div class="version">
                1.0.1.dev11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/theory.html">Background Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Pycsou API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../classes/index.html">Abstract Classes</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Linear Operators</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pycsou.linop.base.html">Constructors</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycsou.linop.conv.html">Convolution Operators</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Differential Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycsou.linop.sampling.html">Sampling Operators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../functionals/index.html">Cost Functionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../algorithms/pycsou.opt.proxalgs.html">Proximal Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/index.html">Mathematical Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Pycsou Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notes/index.html">Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pycsou</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Pycsou API</a> &raquo;</li>
        
          <li><a href="index.html">Linear Operators</a> &raquo;</li>
        
      <li>Differential Operators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/operators/pycsou.linop.diff.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pycsou.linop.diff">
<span id="differential-operators"></span><h1>Differential Operators<a class="headerlink" href="#module-pycsou.linop.diff" title="Permalink to this headline">¶</a></h1>
<p>Discrete differential and integral operators.</p>
<p>This module provides differential operators for discrete signals defined over regular grids or arbitrary meshes (graphs).</p>
<p>Many of the linear operators provided in this module are derived from linear operators from <a class="reference external" href="https://pylops.readthedocs.io/en/latest/api/index.html#smoothing-and-derivatives">PyLops</a>.</p>
<p class="rubric">1D Operators</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FirstDerivative</span></code></a>(size[, shape, axis, step, …])</p></td>
<td><p>First derivative.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.diff.SecondDerivative" title="pycsou.linop.diff.SecondDerivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SecondDerivative</span></code></a>(size[, shape, axis, step, …])</p></td>
<td><p>Second derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.GeneralisedDerivative" title="pycsou.linop.diff.GeneralisedDerivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralisedDerivative</span></code></a>(size[, shape, axis, …])</p></td>
<td><p>Generalised derivative.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.diff.Integration1D" title="pycsou.linop.diff.Integration1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Integration1D</span></code></a>(size[, shape, axis, step, dtype])</p></td>
<td><p>1D integral/cumsum operator.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">2D Operators</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.Gradient" title="pycsou.linop.diff.Gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Gradient</span></code></a>(shape[, step, edge, dtype, kind])</p></td>
<td><p>Gradient.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.diff.Laplacian" title="pycsou.linop.diff.Laplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Laplacian</span></code></a>(shape[, weights, step, edge, dtype])</p></td>
<td><p>Laplacian.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.GeneralisedLaplacian" title="pycsou.linop.diff.GeneralisedLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralisedLaplacian</span></code></a>([shape, step, edge, …])</p></td>
<td><p>Generalised Laplacian operator.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="pycsou.linop.diff.FirstDirectionalDerivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FirstDirectionalDerivative</span></code></a>(shape, directions)</p></td>
<td><p>First directional derivative.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.SecondDirectionalDerivative" title="pycsou.linop.diff.SecondDirectionalDerivative"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SecondDirectionalDerivative</span></code></a>(shape, directions)</p></td>
<td><p>Second directional derivative.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.diff.DirectionalGradient" title="pycsou.linop.diff.DirectionalGradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DirectionalGradient</span></code></a>(…)</p></td>
<td><p>Directional gradient.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.DirectionalLaplacian" title="pycsou.linop.diff.DirectionalLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DirectionalLaplacian</span></code></a>(…[, weights])</p></td>
<td><p>Directional Laplacian.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Graph Operators</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.GraphLaplacian" title="pycsou.linop.diff.GraphLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GraphLaplacian</span></code></a>(Graph[, dtype])</p></td>
<td><p>Graph Laplacian.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.linop.diff.GraphGradient" title="pycsou.linop.diff.GraphGradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GraphGradient</span></code></a>(Graph[, dtype])</p></td>
<td><p>Graph gradient.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.linop.diff.GeneralisedGraphLaplacian" title="pycsou.linop.diff.GeneralisedGraphLaplacian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian</span></code></a>(Graph[, kind])</p></td>
<td><p>Generalised graph Laplacian operator.</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="pycsou.linop.diff.FirstDerivative">
<code class="sig-name descname">FirstDerivative</code><span class="sig-paren">(</span><em class="sig-param">size: int</em>, <em class="sig-param">shape: Optional[tuple] = None</em>, <em class="sig-param">axis: int = 0</em>, <em class="sig-param">step: float = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em>, <em class="sig-param">kind: str = 'forward'</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.PyLopLinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#FirstDerivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.FirstDerivative" title="Permalink to this definition">¶</a></dt>
<dd><p>First derivative.</p>
<p><em>This docstring was adapted from ``pylops.FirstDerivative``.</em></p>
<p>Approximates the first derivative of a multi-dimensional array along a specific <code class="docutils literal notranslate"><span class="pre">axis</span></code> using finite-differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of the input array.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Axis along which to differentiate.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Step size.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – For <code class="docutils literal notranslate"><span class="pre">kind='centered'</span></code>, use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input array.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Derivative kind (<code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">centered</span></code>, or <code class="docutils literal notranslate"><span class="pre">backward</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First derivative operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.PyLopLinearOperator" title="pycsou.linop.base.PyLopLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyLopLinearOperator</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> are not compatible.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">kind</span></code> is not one of: <code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">centered</span></code>, or <code class="docutils literal notranslate"><span class="pre">backward</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dop</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">FirstDerivative</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">Dop_bwd</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;backward&#39;</span><span class="p">)</span>
<span class="n">Dop_fwd</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="n">Dop_cent</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;centered&#39;</span><span class="p">)</span>
<span class="n">y_bwd</span> <span class="o">=</span> <span class="n">Dop_bwd</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">y_cent</span> <span class="o">=</span> <span class="n">Dop_cent</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">y_fwd</span> <span class="o">=</span> <span class="n">Dop_fwd</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y_bwd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y_cent</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y_fwd</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Signal&#39;</span><span class="p">,</span> <span class="s1">&#39;Backward&#39;</span><span class="p">,</span> <span class="s1">&#39;Centered&#39;</span><span class="p">,</span> <span class="s1">&#39;Forward&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First derivative&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-1.py">Source code</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-1.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-1.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/pycsou-linop-diff-1.png" src="../../_images/pycsou-linop-diff-1.png" />
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FirstDerivative</span></code> operator applies a first derivative along a given axis
of a multi-dimensional array using either a <em>second-order centered stencil</em> or <em>first-order forward/backward stencils</em>.</p>
<p>For simplicity, given a one dimensional array, the second-order centered
first derivative is:</p>
<div class="math notranslate nohighlight">
\[y[i] = (0.5x[i+1] - 0.5x[i-1]) / \text{step}\]</div>
<p>while the first-order forward stencil is:</p>
<div class="math notranslate nohighlight">
\[y[i] = (x[i+1] - x[i]) / \text{step}\]</div>
<p>and the first-order backward stencil is:</p>
<div class="math notranslate nohighlight">
\[y[i] = (x[i] - x[i-1]) / \text{step}.\]</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.SecondDerivative" title="pycsou.linop.diff.SecondDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">SecondDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.GeneralisedDerivative" title="pycsou.linop.diff.GeneralisedDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.SecondDerivative">
<code class="sig-name descname">SecondDerivative</code><span class="sig-paren">(</span><em class="sig-param">size: int</em>, <em class="sig-param">shape: Optional[tuple] = None</em>, <em class="sig-param">axis: int = 0</em>, <em class="sig-param">step: float = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.PyLopLinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#SecondDerivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.SecondDerivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Second derivative.</p>
<p><em>This docstring was adapted from ``pylops.SecondDerivative``.</em></p>
<p>Approximates the second derivative of a multi-dimensional array along a specific <code class="docutils literal notranslate"><span class="pre">axis</span></code> using finite-differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of the input array.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Axis along which to differentiate.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Step size.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Second derivative operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.PyLopLinearOperator" title="pycsou.linop.base.PyLopLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PyLopLinearOperator</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">shape</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> are not compatible.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dop</span> <span class="o">=</span> <span class="n">SecondDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">z</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">SecondDerivative</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">SecondDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">z</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">z</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-2.py">Source code</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-2_00_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-2_00_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-2_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/pycsou-linop-diff-2_00_00.png" src="../../_images/pycsou-linop-diff-2_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Second Derivative&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-2_01_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-2_01_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-2_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/pycsou-linop-diff-2_01_00.png" src="../../_images/pycsou-linop-diff-2_01_00.png" />
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SecondDerivative</span></code> operator applies a second derivative to any chosen
direction of a multi-dimensional array.</p>
<p>For simplicity, given a one dimensional array, the second-order centered
second derivative is given by:</p>
<div class="math notranslate nohighlight">
\[y[i] = (x[i+1] - 2x[i] + x[i-1]) / \text{step}^2.\]</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.GeneralisedDerivative" title="pycsou.linop.diff.GeneralisedDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.GeneralisedDerivative">
<code class="sig-name descname">GeneralisedDerivative</code><span class="sig-paren">(</span><em class="sig-param">size: int</em>, <em class="sig-param">shape: Optional[tuple] = None</em>, <em class="sig-param">axis: int = 0</em>, <em class="sig-param">step: float = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em>, <em class="sig-param">kind_op='iterated'</em>, <em class="sig-param">kind_diff='centered'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pycsou.core.linop.LinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GeneralisedDerivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GeneralisedDerivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalised derivative.</p>
<p>Approximates the generalised derivative of a multi-dimensional array along a specific <code class="docutils literal notranslate"><span class="pre">axis</span></code> using finite-differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of the input array.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Axis along which to differentiate.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Step size.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – For <code class="docutils literal notranslate"><span class="pre">kind_diff</span> <span class="pre">=</span> <span class="pre">'centered'</span></code>, use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input array.</p></li>
<li><p><strong>kind_diff</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Derivative kind (<code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">centered</span></code>, or <code class="docutils literal notranslate"><span class="pre">backward</span></code>).</p></li>
<li><p><strong>kind_op</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – <p>Type of generalised derivative (<code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'exponential'</span></code>, <code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>).
Depending on the cases, the <code class="docutils literal notranslate"><span class="pre">GeneralisedDerivative</span></code> operator is defined as follows:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=D^N\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=(\alpha^2 \mathrm{Id}-D^2)^N\)</span>, with <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'exponential'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=(\alpha \mathrm{Id} + D)^N\)</span>,  with <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\sum_{n=0}^N \alpha_n D^n\)</span>,  with <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(D\)</span> is the <a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDerivative()</span></code></a> operator.</p>
</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – <p>Additional arguments depending on the value of <code class="docutils literal notranslate"><span class="pre">kind_op</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev',</span> <span class="pre">'exponential'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int,</span> <span class="pre">constant:</span> <span class="pre">float}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span> and <code class="docutils literal notranslate"><span class="pre">constant</span></code> the scalar <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kind_op='polynomial'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={coeffs:</span> <span class="pre">Union[np.ndarray,</span> <span class="pre">list,</span> <span class="pre">tuple]}</span></code> where <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> is an array containing the coefficients <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A generalised derivative operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">kind_op</span></code> is not one of: <code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'exponential'</span></code>, <code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dop</span> <span class="o">=</span> <span class="n">GeneralisedDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind_op</span><span class="o">=</span><span class="s1">&#39;iterated&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kind_diff</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Dop</span> <span class="o">*</span> <span class="n">z</span><span class="p">,</span> <span class="n">D</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">GeneralisedDerivative</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Dop_it</span> <span class="o">=</span> <span class="n">GeneralisedDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind_op</span><span class="o">=</span><span class="s1">&#39;iterated&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Dop_sob</span> <span class="o">=</span> <span class="n">GeneralisedDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind_op</span><span class="o">=</span><span class="s1">&#39;sobolev&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">Dop_exp</span> <span class="o">=</span> <span class="n">GeneralisedDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind_op</span><span class="o">=</span><span class="s1">&#39;exponential&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">constant</span><span class="o">=-</span><span class="mf">1e-2</span><span class="p">)</span>
<span class="n">Dop_pol</span> <span class="o">=</span> <span class="n">GeneralisedDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">kind_op</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
                                <span class="n">coeffs</span><span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1e-8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">y_it</span> <span class="o">=</span> <span class="n">Dop_it</span> <span class="o">*</span> <span class="n">z</span>
<span class="n">y_sob</span> <span class="o">=</span> <span class="n">Dop_sob</span> <span class="o">*</span> <span class="n">z</span>
<span class="n">y_exp</span> <span class="o">=</span> <span class="n">Dop_exp</span> <span class="o">*</span> <span class="n">z</span>
<span class="n">y_pol</span> <span class="o">=</span> <span class="n">Dop_pol</span> <span class="o">*</span> <span class="n">z</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-3.py">Source code</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-3_00_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-3_00_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-3_00_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/pycsou-linop-diff-3_00_00.png" src="../../_images/pycsou-linop-diff-3_00_00.png" />
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_it</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_sob</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_exp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_pol</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Iterated&#39;</span><span class="p">,</span> <span class="s1">&#39;Sobolev&#39;</span><span class="p">,</span> <span class="s1">&#39;Exponential&#39;</span><span class="p">,</span> <span class="s1">&#39;Polynomial&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Generalised derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-3_01_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-3_01_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-3_01_00.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/pycsou-linop-diff-3_01_00.png" src="../../_images/pycsou-linop-diff-3_01_00.png" />
</div>
<p class="rubric">Notes</p>
<p>Problematic values at edges are set to zero.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.SecondDerivative" title="pycsou.linop.diff.SecondDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">SecondDerivative()</span></code></a>,
<a class="reference internal" href="#pycsou.linop.diff.GeneralisedLaplacian" title="pycsou.linop.diff.GeneralisedLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedLaplacian()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.FirstDirectionalDerivative">
<code class="sig-name descname">FirstDirectionalDerivative</code><span class="sig-paren">(</span><em class="sig-param">shape: tuple</em>, <em class="sig-param">directions: numpy.ndarray</em>, <em class="sig-param">step: Union[float</em>, <em class="sig-param">Tuple[float</em>, <em class="sig-param">...]] = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em>, <em class="sig-param">kind: str = 'centered'</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.PyLopLinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#FirstDirectionalDerivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="Permalink to this definition">¶</a></dt>
<dd><p>First directional derivative.</p>
<p>Computes the directional derivative of a multi-dimensional array (at least two dimensions are required)
along either a single common direction or different <code class="docutils literal notranslate"><span class="pre">directions</span></code> for each entry of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<em>np.ndarray</em>) – Single direction (array of size <span class="math notranslate nohighlight">\(n_{dims}\)</span>) or different directions for each entry (array of size <span class="math notranslate nohighlight">\([n_{dims} \times (n_{d_0} \times ... \times n_{d_{n_{dims}}})]\)</span>).
Each column should be normalised.</p></li>
<li><p><strong>step</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>..</em><em>]</em><em>]</em>) – Step size in each direction.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – For <code class="docutils literal notranslate"><span class="pre">kind</span> <span class="pre">=</span> <span class="pre">'centered'</span></code>, use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input vector.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Derivative kind (<code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">centered</span></code>, or <code class="docutils literal notranslate"><span class="pre">backward</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Directional derivative operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.PyLopLinearOperator" title="pycsou.linop.base.PyLopLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.linop.base.PyLopLinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dop</span> <span class="o">=</span> <span class="n">FirstDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">direction</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">D</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">FirstDirectionalDerivative</span><span class="p">,</span> <span class="n">FirstDerivative</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">directions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">FirstDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal and directions of derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Directional derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-4.py">Source code</a>)</p>
<div class="figure align-default" id="id4">
<img alt="../../_images/pycsou-linop-diff-4_00.png" src="../../_images/pycsou-linop-diff-4_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-4_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-4_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-4_00.pdf">pdf</a>)</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id5">
<img alt="../../_images/pycsou-linop-diff-4_01.png" src="../../_images/pycsou-linop-diff-4_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-4_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-4_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-4_01.pdf">pdf</a>)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">FirstDirectionalDerivative</span></code> applies a first-order derivative
to a multi-dimensional array along the direction defined by the unitary
vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span>:</p>
<div class="math notranslate nohighlight">
\[d_\mathbf{v}f =
    \langle\nabla f, \mathbf{v}\rangle,\]</div>
<p>or along the directions defined by the unitary vectors
<span class="math notranslate nohighlight">\(\mathbf{v}(x, y)\)</span>:</p>
<div class="math notranslate nohighlight">
\[d_\mathbf{v}(x,y) f =
    \langle\nabla f(x,y), \mathbf{v}(x,y)\rangle\]</div>
<p>where we have here considered the 2-dimensional case.
Note that the 2D case, choosing <span class="math notranslate nohighlight">\(\mathbf{v}=[1,0]\)</span> or <span class="math notranslate nohighlight">\(\mathbf{v}=[0,1]\)</span>
is equivalent to the <code class="docutils literal notranslate"><span class="pre">FirstDerivative</span></code> operator applied to axis 0 or 1 respectively.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.SecondDirectionalDerivative" title="pycsou.linop.diff.SecondDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">SecondDirectionalDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.SecondDirectionalDerivative">
<code class="sig-name descname">SecondDirectionalDerivative</code><span class="sig-paren">(</span><em class="sig-param">shape: tuple</em>, <em class="sig-param">directions: numpy.ndarray</em>, <em class="sig-param">step: Union[float</em>, <em class="sig-param">Tuple[float</em>, <em class="sig-param">...]] = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/linop/diff.html#SecondDirectionalDerivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.SecondDirectionalDerivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Second directional derivative.</p>
<p>Computes the second directional derivative of a multi-dimensional array (at least two dimensions are required)
along either a single common direction or different <code class="docutils literal notranslate"><span class="pre">directions</span></code> for each entry of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>directions</strong> (<em>np.ndarray</em>) – Single direction (array of size <span class="math notranslate nohighlight">\(n_{dims}\)</span>) or different directions for each entry (array of size <span class="math notranslate nohighlight">\([n_{dims} \times (n_{d_0} \times ... \times n_{d_{n_{dims}}})]\)</span>).
Each column should be normalised.</p></li>
<li><p><strong>step</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>..</em><em>]</em><em>]</em>) – Step size in each direction.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Second directional derivative operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.PyLopLinearOperator" title="pycsou.linop.base.PyLopLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.linop.base.PyLopLinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dop</span> <span class="o">=</span> <span class="n">SecondDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">direction</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dir_d2</span> <span class="o">=</span> <span class="p">(</span><span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">FirstDirectionalDerivative</span><span class="p">,</span> <span class="n">SecondDirectionalDerivative</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">directions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">FirstDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">Dop2</span> <span class="o">=</span> <span class="n">SecondDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">Dop2</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal and directions of derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;First Directional derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y2</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Second Directional derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-5.py">Source code</a>)</p>
<div class="figure align-default" id="id6">
<img alt="../../_images/pycsou-linop-diff-5_00.png" src="../../_images/pycsou-linop-diff-5_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-5_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-5_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-5_00.pdf">pdf</a>)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id7">
<img alt="../../_images/pycsou-linop-diff-5_01.png" src="../../_images/pycsou-linop-diff-5_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-5_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-5_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-5_01.pdf">pdf</a>)</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id8">
<img alt="../../_images/pycsou-linop-diff-5_02.png" src="../../_images/pycsou-linop-diff-5_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-5_02.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-5_02.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-5_02.pdf">pdf</a>)</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SecondDirectionalDerivative</span></code> applies a second-order derivative
to a multi-dimensional array along the direction defined by the unitary
vector <span class="math notranslate nohighlight">\(\mathbf{v}\)</span>:</p>
<div class="math notranslate nohighlight">
\[d^2_\mathbf{v} f =
    - d_\mathbf{v}^\ast (d_\mathbf{v} f)\]</div>
<p>where <span class="math notranslate nohighlight">\(d_\mathbf{v}\)</span> is the first-order directional derivative
implemented by <a class="reference internal" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="pycsou.linop.diff.FirstDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDirectionalDerivative()</span></code></a>. The above formula generalises the well-known relationship:</p>
<div class="math notranslate nohighlight">
\[\Delta f= -\text{div}(\nabla f),\]</div>
<p>where minus the divergence operator is the adjoint of the gradient.</p>
<p><strong>Note that problematic values at edges are set to zero.</strong></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="pycsou.linop.diff.FirstDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDirectionalDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.SecondDerivative" title="pycsou.linop.diff.SecondDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">SecondDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.DirectionalGradient">
<code class="sig-name descname">DirectionalGradient</code><span class="sig-paren">(</span><em class="sig-param">first_directional_derivatives: List[pycsou.linop.diff.FirstDirectionalDerivative]</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.LinOpVStack<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#DirectionalGradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.DirectionalGradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Directional gradient.</p>
<p>Computes the directional derivative of a multi-dimensional array (at least two dimensions are required)
along multiple <code class="docutils literal notranslate"><span class="pre">directions</span></code> for each entry of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>first_directional_derivatives</strong> (<em>List</em><em>[</em><em>FirstDirectionalDerivative</em><em>]</em>) – List of the directional derivatives to be stacked.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stack of first directional derivatives.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">FirstDirectionalDerivative</span><span class="p">,</span> <span class="n">DirectionalGradient</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">Dop1</span> <span class="o">=</span> <span class="n">FirstDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions1</span><span class="p">)</span>
<span class="n">Dop2</span> <span class="o">=</span> <span class="n">FirstDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions2</span><span class="p">)</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">DirectionalGradient</span><span class="p">([</span><span class="n">Dop1</span><span class="p">,</span> <span class="n">Dop2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal and directions of derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="p">[:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Directional derivatives in 1st direction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Directional derivatives in 2nd direction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-6.py">Source code</a>)</p>
<div class="figure align-default" id="id9">
<img alt="../../_images/pycsou-linop-diff-6_00.png" src="../../_images/pycsou-linop-diff-6_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-6_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-6_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-6_00.pdf">pdf</a>)</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id10">
<img alt="../../_images/pycsou-linop-diff-6_01.png" src="../../_images/pycsou-linop-diff-6_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-6_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-6_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-6_01.pdf">pdf</a>)</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id11">
<img alt="../../_images/pycsou-linop-diff-6_02.png" src="../../_images/pycsou-linop-diff-6_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-6_02.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-6_02.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-6_02.pdf">pdf</a>)</span><a class="headerlink" href="#id11" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalGradient</span></code> of a multivariate function <span class="math notranslate nohighlight">\(f(\mathbf{x})\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}d_{\mathbf{v}_1(\mathbf{x}),\ldots,\mathbf{v}_N(\mathbf{x})} f =
    \left[\begin{array}{c}
    \langle\nabla f, \mathbf{v}_1(\mathbf{x})\rangle\\
    \vdots\\
    \langle\nabla f, \mathbf{v}_N(\mathbf{x})\rangle
    \end{array}\right],\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d_\mathbf{v}\)</span> is the first-order directional derivative
implemented by <a class="reference internal" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="pycsou.linop.diff.FirstDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDirectionalDerivative()</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.Gradient" title="pycsou.linop.diff.Gradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">Gradient()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="pycsou.linop.diff.FirstDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDirectionalDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.DirectionalLaplacian">
<code class="sig-name descname">DirectionalLaplacian</code><span class="sig-paren">(</span><em class="sig-param">second_directional_derivatives: List[pycsou.linop.diff.SecondDirectionalDerivative], weights: Optional[Iterable[float]] = None</em><span class="sig-paren">)</span> &#x2192; pycsou.core.linop.LinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#DirectionalLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.DirectionalLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Directional Laplacian.</p>
<p>Sum of the second directional derivatives of a multi-dimensional array (at least two dimensions are required)
along multiple <code class="docutils literal notranslate"><span class="pre">directions</span></code> for each entry of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>second_directional_derivatives</strong> (<em>List</em><em>[</em><em>SecondDirectionalDerivative</em><em>]</em>) – List of the second directional derivatives to be summed.</p></li>
<li><p><strong>weights</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em><em>]</em>) – List of optional positive weights with which each second directional derivative operator is multiplied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Directional Laplacian.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">SecondDirectionalDerivative</span><span class="p">,</span> <span class="n">DirectionalLaplacian</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">directions1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">directions2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="o">//</span><span class="mi">2</span><span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">Dop1</span> <span class="o">=</span> <span class="n">SecondDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions1</span><span class="p">)</span>
<span class="n">Dop2</span> <span class="o">=</span> <span class="n">SecondDirectionalDerivative</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">directions</span><span class="o">=</span><span class="n">directions2</span><span class="p">)</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">DirectionalLaplacian</span><span class="p">([</span><span class="n">Dop1</span><span class="p">,</span> <span class="n">Dop2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">directions2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal and directions of derivatives&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Directional Laplacian&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-7.py">Source code</a>)</p>
<div class="figure align-default" id="id12">
<img alt="../../_images/pycsou-linop-diff-7_00.png" src="../../_images/pycsou-linop-diff-7_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-7_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-7_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-7_00.pdf">pdf</a>)</span><a class="headerlink" href="#id12" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id13">
<img alt="../../_images/pycsou-linop-diff-7_01.png" src="../../_images/pycsou-linop-diff-7_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-7_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-7_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-7_01.pdf">pdf</a>)</span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DirectionalLaplacian</span></code> of a multivariate function <span class="math notranslate nohighlight">\(f(\mathbf{x})\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[d^2_{\mathbf{v}_1(\mathbf{x}),\ldots,\mathbf{v}_N(\mathbf{x})} f =
    -\sum_{n=1}^N
    d^\ast_{\mathbf{v}_n(\mathbf{x})}(d_{\mathbf{v}_n(\mathbf{x})} f).\]</div>
<p>where <span class="math notranslate nohighlight">\(d_\mathbf{v}\)</span> is the first-order directional derivative
implemented by <a class="reference internal" href="#pycsou.linop.diff.FirstDirectionalDerivative" title="pycsou.linop.diff.FirstDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDirectionalDerivative()</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.SecondDirectionalDerivative" title="pycsou.linop.diff.SecondDirectionalDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">SecondDirectionalDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.Laplacian" title="pycsou.linop.diff.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.Gradient">
<code class="sig-name descname">Gradient</code><span class="sig-paren">(</span><em class="sig-param">shape: tuple</em>, <em class="sig-param">step: Union[tuple</em>, <em class="sig-param">float] = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em>, <em class="sig-param">kind: str = 'centered'</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.PyLopLinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#Gradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.Gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient.</p>
<p>Computes the gradient of a multi-dimensional array (at least two dimensions are required).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>step</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>..</em><em>]</em><em>]</em>) – Step size in each direction.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – For <code class="docutils literal notranslate"><span class="pre">kind</span> <span class="pre">=</span> <span class="pre">'centered'</span></code>, use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input vector.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Derivative kind (<code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">centered</span></code>, or <code class="docutils literal notranslate"><span class="pre">backward</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gradient operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Nabla</span> <span class="o">=</span> <span class="n">Gradient</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">FirstDerivative</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;forward&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="n">Nabla</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">())[:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">],</span> <span class="n">D</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">Gradient</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">Gradient</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="p">[:</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gradient (1st component)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="p">[</span><span class="n">Z</span><span class="o">.</span><span class="n">size</span><span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gradient (2nd component)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-8.py">Source code</a>)</p>
<div class="figure align-default" id="id14">
<img alt="../../_images/pycsou-linop-diff-8_00.png" src="../../_images/pycsou-linop-diff-8_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-8_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-8_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-8_00.pdf">pdf</a>)</span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id15">
<img alt="../../_images/pycsou-linop-diff-8_01.png" src="../../_images/pycsou-linop-diff-8_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-8_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-8_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-8_01.pdf">pdf</a>)</span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id16">
<img alt="../../_images/pycsou-linop-diff-8_02.png" src="../../_images/pycsou-linop-diff-8_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-8_02.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-8_02.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-8_02.pdf">pdf</a>)</span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Gradient</span></code> operator applies a first-order derivative to each dimension of
a multi-dimensional array in forward mode.</p>
<p>For simplicity, given a three dimensional array, the <code class="docutils literal notranslate"><span class="pre">Gradient</span></code> in forward
mode using a centered stencil can be expressed as:</p>
<div class="math notranslate nohighlight">
\[\mathbf{g}_{i, j, k} =
    (f_{i+1, j, k} - f_{i-1, j, k}) / d_1 \mathbf{i_1} +
    (f_{i, j+1, k} - f_{i, j-1, k}) / d_2 \mathbf{i_2} +
    (f_{i, j, k+1} - f_{i, j, k-1}) / d_3 \mathbf{i_3}\]</div>
<p>which is discretized as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{g}  =
\begin{bmatrix}
   \mathbf{df_1} \\
   \mathbf{df_2} \\
   \mathbf{df_3}
\end{bmatrix}.\end{split}\]</div>
<p>In adjoint mode, the adjoints of the first derivatives along different
axes are instead summed together.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.DirectionalGradient" title="pycsou.linop.diff.DirectionalGradient"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalGradient()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.Laplacian">
<code class="sig-name descname">Laplacian</code><span class="sig-paren">(</span><em class="sig-param">shape: tuple</em>, <em class="sig-param">weights: Tuple[float] = (1</em>, <em class="sig-param">1)</em>, <em class="sig-param">step: Union[tuple</em>, <em class="sig-param">float] = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.PyLopLinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#Laplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.Laplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Laplacian.</p>
<p>Computes the Laplacian of a 2D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>weights</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>]</em>) – Weight to apply to each direction (real laplacian operator if <code class="docutils literal notranslate"><span class="pre">weights=[1,1]</span></code>)</p></li>
<li><p><strong>step</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>, </em><em>..</em><em>]</em><em>]</em>) – Step size in each direction.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input vector.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Derivative kind (<code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">centered</span></code>, or <code class="docutils literal notranslate"><span class="pre">backward</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Laplacian operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">Laplacian</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">Laplacian</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laplacian&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-9.py">Source code</a>)</p>
<div class="figure align-default" id="id17">
<img alt="../../_images/pycsou-linop-diff-9_00.png" src="../../_images/pycsou-linop-diff-9_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-9_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-9_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-9_00.pdf">pdf</a>)</span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id18">
<img alt="../../_images/pycsou-linop-diff-9_01.png" src="../../_images/pycsou-linop-diff-9_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-9_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-9_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-9_01.pdf">pdf</a>)</span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The Laplacian operator sums the second directional derivatives of a 2D array along the two canonical directions.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[y[i, j] =\frac{x[i+1, j] + x[i-1, j] + x[i, j-1] +x[i, j+1] - 4x[i, j]}
          {dx\times dy}.\]</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.DirectionalLaplacian" title="pycsou.linop.diff.DirectionalLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">DirectionalLaplacian()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.SecondDerivative" title="pycsou.linop.diff.SecondDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">SecondDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.GeneralisedLaplacian">
<code class="sig-name descname">GeneralisedLaplacian</code><span class="sig-paren">(</span><em class="sig-param">shape: Optional[tuple] = None</em>, <em class="sig-param">step: Union[tuple</em>, <em class="sig-param">float] = 1.0</em>, <em class="sig-param">edge: bool = True</em>, <em class="sig-param">dtype: str = 'float64'</em>, <em class="sig-param">kind='iterated'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pycsou.core.linop.LinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GeneralisedLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GeneralisedLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalised Laplacian operator.</p>
<p>Generalised Laplacian operator for a 2D array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) – Shape of the input array.</p></li>
<li><p><strong>step</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a><em>] </em><em>= 1.</em>) – Step size for each dimension.</p></li>
<li><p><strong>edge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) – Use reduced order derivative at edges (<code class="docutils literal notranslate"><span class="pre">True</span></code>) or ignore them (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input array.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – <p>Type of generalised differential operator (<code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>).
Depending on the cases, the <code class="docutils literal notranslate"><span class="pre">GeneralisedLaplacian</span></code> operator is defined as follows:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\Delta^N\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=(\alpha^2 \mathrm{Id}-\Delta)^N\)</span>, with <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\sum_{n=0}^N \alpha_n \Delta^n\)</span>,  with <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\Delta\)</span> is the <a class="reference internal" href="#pycsou.linop.diff.Laplacian" title="pycsou.linop.diff.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a> operator.</p>
</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – <p>Additional arguments depending on the value of <code class="docutils literal notranslate"><span class="pre">kind</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int,</span> <span class="pre">constant:</span> <span class="pre">float}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span> and <code class="docutils literal notranslate"><span class="pre">constant</span></code> the scalar <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={coeffs:</span> <span class="pre">Union[np.ndarray,</span> <span class="pre">list,</span> <span class="pre">tuple]}</span></code> where <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> is an array containing the coefficients <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Generalised Laplacian operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">kind</span></code> is not one of: <code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">GeneralisedLaplacian</span>
<span class="kn">from</span> <span class="nn">pycsou.util.misc</span> <span class="kn">import</span> <span class="n">peaks</span>

<span class="n">x</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span><span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">GeneralisedLaplacian</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">Z</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;sobolev&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">Z</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sobolev&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-10.py">Source code</a>)</p>
<div class="figure align-default" id="id19">
<img alt="../../_images/pycsou-linop-diff-10_00.png" src="../../_images/pycsou-linop-diff-10_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-10_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-10_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-10_00.pdf">pdf</a>)</span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id20">
<img alt="../../_images/pycsou-linop-diff-10_01.png" src="../../_images/pycsou-linop-diff-10_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-10_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-10_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-10_01.pdf">pdf</a>)</span><a class="headerlink" href="#id20" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>Problematic values at edges are set to zero.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.GeneralisedDerivative" title="pycsou.linop.diff.GeneralisedDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.Laplacian" title="pycsou.linop.diff.Laplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Laplacian()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.Integration1D">
<code class="sig-name descname">Integration1D</code><span class="sig-paren">(</span><em class="sig-param">size: int</em>, <em class="sig-param">shape: Optional[tuple] = None</em>, <em class="sig-param">axis: int = 0</em>, <em class="sig-param">step: float = 1.0</em>, <em class="sig-param">dtype='float64'</em><span class="sig-paren">)</span> &#x2192; pycsou.linop.base.PyLopLinearOperator<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#Integration1D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.Integration1D" title="Permalink to this definition">¶</a></dt>
<dd><p>1D integral/cumsum operator.</p>
<p>Integrates a multi-dimensional array along a specific <code class="docutils literal notranslate"><span class="pre">axis</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Size of the input array.</p></li>
<li><p><strong>shape</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a><em>]</em>) – Shape of the input array if multi-dimensional.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Axis along which integration is performed.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Step size.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Type of elements in input array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Integral operator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="pycsou.linop.base.html#pycsou.linop.base.PyLopLinearOperator" title="pycsou.linop.base.PyLopLinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.linop.base.PyLopLinearOperator</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">Integration1D</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Int</span> <span class="o">=</span> <span class="n">Integration1D</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Int</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Signal&#39;</span><span class="p">,</span> <span class="s1">&#39;Integral&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Integration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-11.py">Source code</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-11.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-11.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-11.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../../_images/pycsou-linop-diff-111.png" src="../../_images/pycsou-linop-diff-111.png" />
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Integration1D</span></code> operator applies a causal integration to any chosen
direction of a multi-dimensional array.</p>
<p>For simplicity, given a one dimensional array, the causal integration is:</p>
<div class="math notranslate nohighlight">
\[y(t) = \int x(t) dt\]</div>
<p>which can be discretised as :</p>
<div class="math notranslate nohighlight">
\[y[i] = \sum_{j=0}^i x[j] dt,\]</div>
<p>where <span class="math notranslate nohighlight">\(dt\)</span> is the <code class="docutils literal notranslate"><span class="pre">sampling</span></code> interval.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.FirstDerivative" title="pycsou.linop.diff.FirstDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">FirstDerivative()</span></code></a></p>
</div>
</dd></dl>

<dl class="class">
<dt id="pycsou.linop.diff.GraphLaplacian">
<em class="property">class </em><code class="sig-name descname">GraphLaplacian</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GraphLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GraphLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Graph Laplacian.</p>
<p>Normalised graph Laplacian for signals defined on graphs.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pygsp.graphs</span> <span class="kn">import</span> <span class="n">Ring</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">GraphLaplacian</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Ring</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">lap_type</span><span class="o">=</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">])</span>
<span class="n">Lap</span> <span class="o">=</span> <span class="n">GraphLaplacian</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
<span class="n">lap_sig</span> <span class="o">=</span> <span class="n">Lap</span> <span class="o">*</span> <span class="n">signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">lap_sig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laplacian of signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">lap_sig</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Laplacian of signal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-12.py">Source code</a>)</p>
<div class="figure align-default" id="id21">
<img alt="../../_images/pycsou-linop-diff-12_00.png" src="../../_images/pycsou-linop-diff-12_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-12_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_00.pdf">pdf</a>)</span><a class="headerlink" href="#id21" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id22">
<img alt="../../_images/pycsou-linop-diff-12_01.png" src="../../_images/pycsou-linop-diff-12_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-12_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_01.pdf">pdf</a>)</span><a class="headerlink" href="#id22" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id23">
<img alt="../../_images/pycsou-linop-diff-12_02.png" src="../../_images/pycsou-linop-diff-12_02.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-12_02.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_02.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_02.pdf">pdf</a>)</span><a class="headerlink" href="#id23" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id24">
<img alt="../../_images/pycsou-linop-diff-12_03.png" src="../../_images/pycsou-linop-diff-12_03.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-12_03.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_03.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-12_03.pdf">pdf</a>)</span><a class="headerlink" href="#id24" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>For undirected graphs, the normalized graph Laplacian is defined as</p>
<div class="math notranslate nohighlight">
\[\mathbf{L} = \mathbf{I} - \mathbf{D}^{-1/2} \mathbf{W} \mathbf{D}^{-1/2},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{I}\)</span> is the identity matrix, <span class="math notranslate nohighlight">\(\mathbf{W}\)</span> is the weighted adjacency matrix and <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> the
weighted degree matrix.</p>
<p>For directed graphs, the Laplacians are built from a symmetrized
version of the weighted adjacency matrix that is the average of the
weighted adjacency matrix and its transpose. As the Laplacian is
defined as the divergence of the gradient, it is not affected by the
orientation of the edges.</p>
<p>For both Laplacians, the diagonal entries corresponding to disconnected
nodes (i.e., nodes with degree zero) are set to zero.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GraphLaplacian</span></code> operator is self-adjoint.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.GraphGradient" title="pycsou.linop.diff.GraphGradient"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphGradient</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.GeneralisedGraphLaplacian" title="pycsou.linop.diff.GeneralisedGraphLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian()</span></code></a>
<a class="reference internal" href="pycsou.linop.conv.html#pycsou.linop.conv.GraphConvolution" title="pycsou.linop.conv.GraphConvolution"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphConvolution</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.linop.diff.GraphLaplacian.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GraphLaplacian.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GraphLaplacian.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Graph</strong> (<a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph">pygsp.graphs.Graph</a>) – Graph on which the signal is defined, with normalised Laplacian <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> precomputed (see <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph.compute_laplacian">pygsp.graphs.Graph.compute_laplacian(lap_type=’normalized’)</a>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the entries of the graph filer.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> does not exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.lap_type</span></code> is ‘combinatorial’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.diff.GraphLaplacian.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GraphLaplacian.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GraphLaplacian.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.linop.diff.GraphGradient">
<em class="property">class </em><code class="sig-name descname">GraphGradient</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GraphGradient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GraphGradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.linop.LinearOperator</span></code></a></p>
<p>Graph gradient.</p>
<p>Gradient operator for signals defined on graphs.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">Ring</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">lap_type</span><span class="o">=</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">compute_differential_operator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lap</span> <span class="o">=</span> <span class="n">GraphLaplacian</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Grad</span> <span class="o">=</span> <span class="n">GraphGradient</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lap_sig</span> <span class="o">=</span> <span class="n">Lap</span> <span class="o">*</span> <span class="n">signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lap_sig2</span> <span class="o">=</span> <span class="n">Grad</span><span class="o">.</span><span class="n">adjoint</span><span class="p">(</span><span class="n">Grad</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">lap_sig</span><span class="p">,</span> <span class="n">lap_sig2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The adjoint of the <code class="docutils literal notranslate"><span class="pre">GraphGradient</span></code> operator is called the graph divergence operator.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In the newest version of PyGSP (&gt; 0.5.1) the convention is changed: <code class="docutils literal notranslate"><span class="pre">Graph.D</span></code> is the divergence operator and
<code class="docutils literal notranslate"><span class="pre">Graph.D.transpose()</span></code> the gradient (see routine <a class="reference external" href="https://pygsp.readthedocs.io/en/latest/reference/graphs.html#pygsp.graphs.Graph.compute_differential_operator">Graph.compute_differential_operator</a>). The code should be adapted when this new version is released.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.GraphLaplacian" title="pycsou.linop.diff.GraphLaplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphLaplacian</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.GeneralisedGraphLaplacian" title="pycsou.linop.diff.GeneralisedGraphLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian()</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.linop.diff.GraphGradient.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">dtype: type = &lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GraphGradient.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GraphGradient.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Graph</strong> – Graph on which the signal is defined, with differential operator <code class="docutils literal notranslate"><span class="pre">Graph.D</span></code> precomputed (see <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph.compute_differential_operator">pygsp.graphs.Graph.compute_differential_operator()</a>.</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the entries of the graph filer.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.D</span></code> does not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.linop.diff.GraphGradient.adjoint">
<code class="sig-name descname">adjoint</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GraphGradient.adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GraphGradient.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the adjoint of the operator at a point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the adjoint should be evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the adjoint at <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycsou.linop.diff.GeneralisedGraphLaplacian">
<code class="sig-name descname">GeneralisedGraphLaplacian</code><span class="sig-paren">(</span><em class="sig-param">Graph: pygsp.graphs.graph.Graph</em>, <em class="sig-param">kind: str = 'iterated'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/linop/diff.html#GeneralisedGraphLaplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.linop.diff.GeneralisedGraphLaplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalised graph Laplacian operator.</p>
<p>Generalised Laplacian operator signals defined on graphs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Graph</strong> – <p>Graph on which the signal is defined, with normalised Laplacian <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> precomputed (see <a class="reference external" href="https://pygsp.readthedocs.io/en/stable/reference/graphs.html#pygsp.graphs.Graph.compute_laplacian">pygsp.graphs.Graph.compute_laplacian(lap_type=’normalized’)</a>.</p>
</p></li>
<li><p><strong>dtype</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.9)"><em>type</em></a>) – Type of the entries of the graph filer.</p></li>
<li><p><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – <p>Type of generalised differential operator (<code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>, <code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>).
Depending on the cases, the <code class="docutils literal notranslate"><span class="pre">GeneralisedLaplacian</span></code> operator is defined as follows:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\mathbf{L}^N\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=(\alpha^2 \mathrm{Id}-\mathbf{L})^N\)</span>, with <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <span class="math notranslate nohighlight">\(\mathscr{D}=\sum_{n=0}^N \alpha_n \mathbf{L}^n\)</span>,  with <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>,</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> is the <a class="reference internal" href="#pycsou.linop.diff.GraphLaplacian" title="pycsou.linop.diff.GraphLaplacian"><code class="xref py py-func docutils literal notranslate"><span class="pre">GraphLaplacian()</span></code></a> operator.</p>
</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>) – <p>Additional arguments depending on the value of <code class="docutils literal notranslate"><span class="pre">kind</span></code>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'iterated'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sobolev'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={order:</span> <span class="pre">int,</span> <span class="pre">constant:</span> <span class="pre">float}</span></code> where <code class="docutils literal notranslate"><span class="pre">order</span></code> defines the exponent <span class="math notranslate nohighlight">\(N\)</span> and <code class="docutils literal notranslate"><span class="pre">constant</span></code> the scalar <span class="math notranslate nohighlight">\(\alpha\in\mathbb{R}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'polynomial'</span></code>: <code class="docutils literal notranslate"><span class="pre">kwargs={coeffs:</span> <span class="pre">Union[np.ndarray,</span> <span class="pre">list,</span> <span class="pre">tuple]}</span></code> where <code class="docutils literal notranslate"><span class="pre">coeffs</span></code> is an array containing the coefficients <span class="math notranslate nohighlight">\(\{\alpha_0,\ldots,\alpha_N\} \subset\mathbb{R}\)</span>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.L</span></code> does not exist.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">Graph.lap_type</span></code> is ‘combinatorial’.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.9)"><strong>NotImplementedError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">kind</span></code> is not ‘iterated’, ‘sobolev’ or ‘polynomial’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pygsp.graphs</span> <span class="kn">import</span> <span class="n">Ring</span>
<span class="kn">from</span> <span class="nn">pycsou.linop.diff</span> <span class="kn">import</span> <span class="n">GeneralisedGraphLaplacian</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">Ring</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">lap_type</span><span class="o">=</span><span class="s1">&#39;normalized&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">set_coordinates</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;spring&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">piecewise</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="o">&lt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">G</span><span class="o">.</span><span class="n">N</span><span class="p">])</span>
<span class="n">Dop</span> <span class="o">=</span> <span class="n">GeneralisedGraphLaplacian</span><span class="p">(</span><span class="n">Graph</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="n">coeffs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">gen_lap</span> <span class="o">=</span> <span class="n">Dop</span> <span class="o">*</span> <span class="n">signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot_signal</span><span class="p">(</span><span class="n">gen_lap</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;matplotlib&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Generalized Laplacian of signal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../api/operators/pycsou-linop-diff-13.py">Source code</a>)</p>
<div class="figure align-default" id="id25">
<img alt="../../_images/pycsou-linop-diff-13_00.png" src="../../_images/pycsou-linop-diff-13_00.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-13_00.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-13_00.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-13_00.pdf">pdf</a>)</span><a class="headerlink" href="#id25" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="id26">
<img alt="../../_images/pycsou-linop-diff-13_01.png" src="../../_images/pycsou-linop-diff-13_01.png" />
<p class="caption"><span class="caption-text">(<a class="reference external" href="../../api/operators/pycsou-linop-diff-13_01.png">png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-13_01.hires.png">hires.png</a>, <a class="reference external" href="../../api/operators/pycsou-linop-diff-13_01.pdf">pdf</a>)</span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</div>
<p class="rubric">Notes</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GeneralisedGraphLaplacian</span></code> operator is self-adjoint.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.linop.diff.GeneralisedDerivative" title="pycsou.linop.diff.GeneralisedDerivative"><code class="xref py py-func docutils literal notranslate"><span class="pre">GeneralisedDerivative()</span></code></a>, <a class="reference internal" href="#pycsou.linop.diff.GeneralisedLaplacian" title="pycsou.linop.diff.GeneralisedLaplacian"><code class="xref py py-class docutils literal notranslate"><span class="pre">GeneralisedLaplacian</span></code></a></p>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pycsou.linop.sampling.html" class="btn btn-neutral float-right" title="Sampling Operators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pycsou.linop.conv.html" class="btn btn-neutral float-left" title="Convolution Operators" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Matthieu SIMEONI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>