

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Penalty Functionals &mdash; pycsou 1.0.6 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/plot_directive.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Loss Functionals" href="pycsou.func.loss.html" />
    <link rel="prev" title="Constructors" href="pycsou.func.base.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pycsou
          

          
          </a>

          
            
            
              <div class="version">
                1.0.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/theory.html">Background Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/pycsou_classes.html">Solving Inverse Problems with Pycsou</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/extensions.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general/examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Pycsou API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../classes/index.html">Abstract Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../operators/index.html">Linear Operators</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Cost Functionals</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="pycsou.func.base.html">Constructors</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Penalty Functionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycsou.func.loss.html">Loss Functionals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../algorithms/pycsou.opt.proxalgs.html">Proximal Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/index.html">Mathematical Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">Pycsou Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">More</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notes/index.html">Notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pycsou</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Pycsou API</a> &raquo;</li>
        
          <li><a href="index.html">Cost Functionals</a> &raquo;</li>
        
      <li>Penalty Functionals</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/functionals/pycsou.func.penalty.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="penalty-functionals">
<span id="penalties"></span><h1>Penalty Functionals<a class="headerlink" href="#penalty-functionals" title="Permalink to this headline">¶</a></h1>
<p>Module: <code class="docutils literal notranslate"><span class="pre">pycsou.func.penalty</span></code></p>
<span class="target" id="module-pycsou.func.penalty"></span><p>Repository of common penalty functionals.</p>
<p class="rubric">Norms</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.L1Norm" title="pycsou.func.penalty.L1Norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L1Norm</span></code></a>(dim)</p></td>
<td><p><span class="math notranslate nohighlight">\(\ell_1\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_1:=\sum_{i=1}^N |x_i|\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.SquaredL1Norm" title="pycsou.func.penalty.SquaredL1Norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SquaredL1Norm</span></code></a>(dim[, prox_computation])</p></td>
<td><p><span class="math notranslate nohighlight">\(\ell^2_1\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert^2_1:=\left(\sum_{i=1}^N |x_i|\right)^2\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.L2Norm" title="pycsou.func.penalty.L2Norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L2Norm</span></code></a>(dim)</p></td>
<td><p><span class="math notranslate nohighlight">\(\ell_2\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_2:=\sqrt{\sum_{i=1}^N |x_i|^2}\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.SquaredL2Norm" title="pycsou.func.penalty.SquaredL2Norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SquaredL2Norm</span></code></a>(dim)</p></td>
<td><p><span class="math notranslate nohighlight">\(\ell^2_2\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert^2_2:=\sum_{i=1}^N |x_i|^2\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.LInftyNorm" title="pycsou.func.penalty.LInftyNorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LInftyNorm</span></code></a>(dim)</p></td>
<td><p><span class="math notranslate nohighlight">\(\ell_\infty\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_\infty:=\max_{i=1,\ldots,N} |x_i|\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.L21Norm" title="pycsou.func.penalty.L21Norm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L21Norm</span></code></a>(dim, groups)</p></td>
<td><p><span class="math notranslate nohighlight">\(\ell_{2,1}\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_{2,1}:=\sum_{g=1}^G \sqrt{ \sum_{i\in\mathcal{G}_g} |x_i|^2}\,.\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.QuadraticForm" title="pycsou.func.penalty.QuadraticForm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QuadraticForm</span></code></a>(dim[, linop])</p></td>
<td><p>Quadratic form <span class="math notranslate nohighlight">\(\mathbf{x}^\ast \mathbf{L} \mathbf{x}\)</span>.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Balls</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.L1Ball" title="pycsou.func.penalty.L1Ball"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L1Ball</span></code></a>(dim, radius)</p></td>
<td><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball <span class="math notranslate nohighlight">\(\{\mathbf{x}\in\mathbb{R}^N: \|\mathbf{x}\|_1\leq \text{radius}\}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.L2Ball" title="pycsou.func.penalty.L2Ball"><code class="xref py py-obj docutils literal notranslate"><span class="pre">L2Ball</span></code></a>(dim, radius)</p></td>
<td><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball <span class="math notranslate nohighlight">\(\{\mathbf{x}\in\mathbb{R}^N: \|\mathbf{x}\|_2\leq \text{radius}\}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.LInftyBall" title="pycsou.func.penalty.LInftyBall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LInftyBall</span></code></a>(dim, radius)</p></td>
<td><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball <span class="math notranslate nohighlight">\(\{\mathbf{x}\in\mathbb{R}^N: \|\mathbf{x}\|_\infty\leq \text{radius}\}\)</span></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Convex Sets</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.ImagLine" title="pycsou.func.penalty.ImagLine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImagLine</span></code></a>(dim)</p></td>
<td><p>Indicator function of the imaginary line <span class="math notranslate nohighlight">\(j\mathbb{R}\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.NonNegativeOrthant" title="pycsou.func.penalty.NonNegativeOrthant"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NonNegativeOrthant</span></code></a>(dim)</p></td>
<td><p>Indicator function of the non negative orthant (positivity constraint).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.RealLine" title="pycsou.func.penalty.RealLine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RealLine</span></code></a>(dim)</p></td>
<td><p>Indicator function of the real line <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.Segment" title="pycsou.func.penalty.Segment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Segment</span></code></a>(dim[, a, b])</p></td>
<td><p>Indicator function of the segment <span class="math notranslate nohighlight">\([a,b]\subset\mathbb{R}\)</span>.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Information Theoretic</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pycsou.func.penalty.LogBarrier" title="pycsou.func.penalty.LogBarrier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LogBarrier</span></code></a>(dim)</p></td>
<td><p>Log barrier, <span class="math notranslate nohighlight">\(f(\mathbf{x}):= -\sum_{i=1}^N \log(x_i).\)</span></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pycsou.func.penalty.ShannonEntropy" title="pycsou.func.penalty.ShannonEntropy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ShannonEntropy</span></code></a>(dim)</p></td>
<td><p>Negative Shannon entropy, <span class="math notranslate nohighlight">\(f(\mathbf{x}):= \sum_{i=1}^N x_i\log(x_i).\)</span></p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="pycsou.func.penalty.L2Norm">
<em class="property">class </em><code class="sig-name descname">L2Norm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L2Norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L2Norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycsou.func.base.html#pycsou.func.base.LpNorm" title="pycsou.func.base.LpNorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.func.base.LpNorm</span></code></a></p>
<p><span class="math notranslate nohighlight">\(\ell_2\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_2:=\sqrt{\sum_{i=1}^N |x_i|^2}\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="n">L2Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">16.881943016134134</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">tau</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">scaled_norm</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">norm</span><span class="p">;</span> <span class="n">scaled_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">50.645829048402405</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">scaled_norm</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">tau</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">/</span> <span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_2\)</span>-norm is a strictly-convex but non differentiable penalty functional.
Solutions to <span class="math notranslate nohighlight">\(\ell_2\)</span>-penalised convex optimisation problems are usually non unique and very smooth.
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-norm can be found in <a class="reference internal" href="../../notes/references.html#proxalg" id="id1"><span>[ProxAlg]</span></a> section 6.5.1.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.L2Loss" title="pycsou.func.loss.L2Loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">L2Loss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.SquaredL2Norm" title="pycsou.func.penalty.SquaredL2Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquaredL2Norm</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L2Ball" title="pycsou.func.penalty.L2Ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">L2Ball()</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.L2Norm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L2Norm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L2Norm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.L2Norm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L2Norm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L2Norm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.SquaredL2Norm">
<em class="property">class </em><code class="sig-name descname">SquaredL2Norm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL2Norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL2Norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.DifferentiableFunctional" title="pycsou.core.functional.DifferentiableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.DifferentiableFunctional</span></code></a></p>
<p><span class="math notranslate nohighlight">\(\ell^2_2\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert^2_2:=\sum_{i=1}^N |x_i|^2\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="n">SquaredL2Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">285.00000000000006</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">scaled_norm</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">norm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaled_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">855.0000000000002</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">scaled_norm</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">*</span>  <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Gmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">DenseLinearOperator</span><span class="p">(</span><span class="n">Gmat</span><span class="p">,</span> <span class="n">is_symmetric</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weighted_norm</span> <span class="o">=</span> <span class="n">norm</span> <span class="o">*</span> <span class="n">G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">weighted_norm</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Gmat</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="p">(</span><span class="n">Gmat</span> <span class="o">@</span> <span class="n">x</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell^2_2\)</span> penalty or <em>Tikhonov</em> penalty is strictly-convex and differentiable. It is used in ridge regression.
Solutions to <span class="math notranslate nohighlight">\(\ell^2_2\)</span>-penalised convex optimisation problems are unique and usually very smooth.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.SquaredL2Loss" title="pycsou.func.loss.SquaredL2Loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">SquaredL2Loss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L2Norm" title="pycsou.func.penalty.L2Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">L2Norm</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L2Ball" title="pycsou.func.penalty.L2Ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">L2Ball()</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.SquaredL2Norm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL2Norm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL2Norm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.SquaredL2Norm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL2Norm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL2Norm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.SquaredL2Norm.jacobianT">
<code class="sig-name descname">jacobianT</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; Union[numbers.Number, numpy.ndarray]<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL2Norm.jacobianT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL2Norm.jacobianT" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient of the squared L2 norm at x.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.L2Ball">
<code class="sig-name descname">L2Ball</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">radius: numbers.Number</em><span class="sig-paren">)</span> &#x2192; pycsou.func.base.IndicatorFunctional<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L2Ball"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L2Ball" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball <span class="math notranslate nohighlight">\(\{\mathbf{x}\in\mathbb{R}^N: \|\mathbf{x}\|_2\leq \text{radius}\}\)</span></p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\|\mathbf{x}\|_2\leq \text{radius},\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>radius</strong> (<em>Number</em>) – Radius of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span> <span class="n">ball</span> <span class="o">=</span> <span class="n">L2Ball</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ball</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">ball</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">proj_l2_ball</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(True, 10.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">x2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball penalty is convex and proximable. It is a constrained variant of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-norm penalty.
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball indicator is the projection onto the <span class="math notranslate nohighlight">\(\ell_2\)</span>-ball
(see <a class="reference internal" href="../../notes/references.html#proxalg" id="id2"><span>[ProxAlg]</span></a> Section 1.2).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.L2BallLoss" title="pycsou.func.loss.L2BallLoss"><code class="xref py py-func docutils literal notranslate"><span class="pre">L2BallLoss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L2Norm" title="pycsou.func.penalty.L2Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">L2Norm</span></code></a>, py:class:<cite>pycsou.class.penalty.SquaredL2Norm</cite>.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.L1Norm">
<em class="property">class </em><code class="sig-name descname">L1Norm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L1Norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L1Norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycsou.func.base.html#pycsou.func.base.LpNorm" title="pycsou.func.base.LpNorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.func.base.LpNorm</span></code></a></p>
<p><span class="math notranslate nohighlight">\(\ell_1\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_1:=\sum_{i=1}^N |x_i|\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="n">L1Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span><span class="o">=</span><span class="mf">1.2</span><span class="p">;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">),</span><span class="n">soft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">scaled_norm</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">norm</span><span class="p">;</span> <span class="n">scaled_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">135</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">scaled_norm</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">),</span><span class="n">soft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="n">tau</span> <span class="o">*</span> <span class="n">lambda_</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_1\)</span>-norm penalty is convex and proximable. This penalty tends to produce non unique and sparse solutions.
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-norm is provided in <a class="reference internal" href="../../notes/references.html#proxalg" id="id3"><span>[ProxAlg]</span></a> Section 6.5.2.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.L1Ball" title="pycsou.func.penalty.L1Ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">L1Ball()</span></code></a>, <a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.L1Loss" title="pycsou.func.loss.L1Loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">L1Loss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.SquaredL1Norm" title="pycsou.func.penalty.SquaredL1Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquaredL1Norm</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.L1Norm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L1Norm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L1Norm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.L1Norm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L1Norm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L1Norm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.L1Norm.soft">
<code class="sig-name descname">soft</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray], tau: numbers.Number</em><span class="sig-paren">)</span> &#x2192; Union[numbers.Number, numpy.ndarray]<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L1Norm.soft"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L1Norm.soft" title="Permalink to this definition">¶</a></dt>
<dd><p>Soft thresholding operator (see <a class="reference internal" href="../math/pycsou.math.prox.html#pycsou.math.prox.soft" title="pycsou.math.prox.soft"><code class="xref py py-func docutils literal notranslate"><span class="pre">soft()</span></code></a> for a definition).</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.SquaredL1Norm">
<em class="property">class </em><code class="sig-name descname">SquaredL1Norm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">prox_computation: str = 'sort'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL1Norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL1Norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.ProximableFunctional" title="pycsou.core.functional.ProximableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.ProximableFunctional</span></code></a></p>
<p><span class="math notranslate nohighlight">\(\ell^2_1\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert^2_1:=\left(\sum_{i=1}^N |x_i|\right)^2\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="n">SquaredL1Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">prox_computation</span><span class="o">=</span><span class="s1">&#39;sort&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2025</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm2</span> <span class="o">=</span> <span class="n">SquaredL1Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">prox_computation</span><span class="o">=</span><span class="s1">&#39;root&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">norm2</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell^2_1\)</span>-norm penalty is strictly-convex and proximable. This penalty tends to produce a unique and sparse solution.
Two alternative ways of computing the proximal operator of the <span class="math notranslate nohighlight">\(\ell^2_1\)</span>-norm are provided in <a class="reference internal" href="../../notes/references.html#firstord" id="id4"><span>[FirstOrd]</span></a> Lemma 6.70
and <a class="reference internal" href="../../notes/references.html#onkerlearn" id="id5"><span>[OnKerLearn]</span></a> Algorithm 2 respectively.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.L1Ball" title="pycsou.func.penalty.L1Ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">L1Ball()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L1Norm" title="pycsou.func.penalty.L1Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">L1Norm</span></code></a>, <code class="xref py py-func docutils literal notranslate"><span class="pre">SquaredL1Loss()</span></code>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.SquaredL1Norm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">prox_computation: str = 'sort'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL1Norm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL1Norm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>prox_computation</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>, </em><em>optional</em>) – Algorithm for computing the proximal operator: ‘root’ uses <a class="reference internal" href="../../notes/references.html#firstord" id="id6"><span>[FirstOrd]</span></a> Lemma 6.70, while ‘sort’ uses <a class="reference internal" href="../../notes/references.html#onkerlearn" id="id7"><span>[OnKerLearn]</span></a> Algorithm 2 (faster).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.SquaredL1Norm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL1Norm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL1Norm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.SquaredL1Norm.prox">
<code class="sig-name descname">prox</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray], tau: numbers.Number</em><span class="sig-paren">)</span> &#x2192; Union[numbers.Number, numpy.ndarray]<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#SquaredL1Norm.prox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.SquaredL1Norm.prox" title="Permalink to this definition">¶</a></dt>
<dd><p>Proximal operator, see <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.ProximableFunctional" title="pycsou.core.functional.ProximableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.ProximableFunctional</span></code></a> for a detailed description.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.L1Ball">
<code class="sig-name descname">L1Ball</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">radius: numbers.Number</em><span class="sig-paren">)</span> &#x2192; pycsou.func.base.IndicatorFunctional<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L1Ball"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L1Ball" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball <span class="math notranslate nohighlight">\(\{\mathbf{x}\in\mathbb{R}^N: \|\mathbf{x}\|_1\leq \text{radius}\}\)</span></p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\|\mathbf{x}\|_1\leq \text{radius},\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>radius</strong> (<em>Number</em>) – Radius of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span><span class="o">=</span><span class="mi">10</span><span class="p">;</span> <span class="n">ball</span> <span class="o">=</span> <span class="n">L1Ball</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ball</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">ball</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">proj_l1_ball</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(True, 10.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">x2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball penalty is convex and proximable. It is a constrained variant of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-norm penalty.
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball indicator is the projection onto the <span class="math notranslate nohighlight">\(\ell_1\)</span>-ball
(see <a class="reference internal" href="../../notes/references.html#proxalg" id="id8"><span>[ProxAlg]</span></a> Section 6.5.2).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.L1BallLoss" title="pycsou.func.loss.L1BallLoss"><code class="xref py py-func docutils literal notranslate"><span class="pre">L1BallLoss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L1Norm" title="pycsou.func.penalty.L1Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">L1Norm</span></code></a>, py:class:<cite>pycsou.func.penalty.SquaredL1Norm</cite>.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.LInftyNorm">
<em class="property">class </em><code class="sig-name descname">LInftyNorm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LInftyNorm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LInftyNorm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="pycsou.func.base.html#pycsou.func.base.LpNorm" title="pycsou.func.base.LpNorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.func.base.LpNorm</span></code></a></p>
<p><span class="math notranslate nohighlight">\(\ell_\infty\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_\infty:=\max_{i=1,\ldots,N} |x_i|\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span> <span class="o">=</span> <span class="n">LInftyNorm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lambda_</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">scaled_norm</span> <span class="o">=</span> <span class="n">lambda_</span> <span class="o">*</span> <span class="n">norm</span><span class="p">;</span> <span class="n">scaled_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">27</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-norm is a convex but non differentiable penalty functional.
Solutions to <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-penalised convex optimisation problems are non unique and binary (i.e. <span class="math notranslate nohighlight">\(x_i\in\{1,-1\}\)</span>).
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-norm does not admit a closed-form but can be computed effficiently
as discussed in <a class="reference internal" href="../../notes/references.html#proxalg" id="id9"><span>[ProxAlg]</span></a> section 6.5.2.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.LInftyLoss" title="pycsou.func.loss.LInftyLoss"><code class="xref py py-func docutils literal notranslate"><span class="pre">LInftyLoss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.LInftyBall" title="pycsou.func.penalty.LInftyBall"><code class="xref py py-func docutils literal notranslate"><span class="pre">LInftyBall()</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.LInftyNorm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LInftyNorm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LInftyNorm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the functional’s domain.</p></li>
<li><p><strong>proj_lq_ball</strong> (<em>Callable</em><em>[</em><em>x: np.ndarray</em><em>, </em><em>radius: float</em><em>]</em>) – Projection onto the <span class="math notranslate nohighlight">\(\ell_q\)</span>-ball where <span class="math notranslate nohighlight">\(1/p+1/q=1.\)</span></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="../math/pycsou.math.prox.html#pycsou.math.prox.proj_l2_ball" title="pycsou.math.prox.proj_l2_ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">proj_l2_ball()</span></code></a>, <a class="reference internal" href="../math/pycsou.math.prox.html#pycsou.math.prox.proj_l1_ball" title="pycsou.math.prox.proj_l1_ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">proj_l1_ball()</span></code></a>, <a class="reference internal" href="../math/pycsou.math.prox.html#pycsou.math.prox.proj_linfty_ball" title="pycsou.math.prox.proj_linfty_ball"><code class="xref py py-func docutils literal notranslate"><span class="pre">proj_linfty_ball()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.LInftyNorm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LInftyNorm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LInftyNorm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.LInftyBall">
<code class="sig-name descname">LInftyBall</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">radius: numbers.Number</em><span class="sig-paren">)</span> &#x2192; pycsou.func.base.IndicatorFunctional<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LInftyBall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LInftyBall" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball <span class="math notranslate nohighlight">\(\{\mathbf{x}\in\mathbb{R}^N: \|\mathbf{x}\|_\infty\leq \text{radius}\}\)</span></p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\|\mathbf{x}\|_\infty\leq \text{radius},\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>radius</strong> (<em>Number</em>) – Radius of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span> <span class="n">ball</span> <span class="o">=</span> <span class="n">LInftyBall</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ball</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">ball</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">proj_linfty_ball</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="nb">ord</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="go">(True, 8.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">ball</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">x2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball penalty is convex and proximable. It is a constrained variant of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-norm penalty.
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball indicator is the projection onto the <span class="math notranslate nohighlight">\(\ell_\infty\)</span>-ball
(see <a class="reference internal" href="../../notes/references.html#proxalg" id="id10"><span>[ProxAlg]</span></a> Section 6.5.2).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.LInftyBallLoss" title="pycsou.func.loss.LInftyBallLoss"><code class="xref py py-func docutils literal notranslate"><span class="pre">LInftyBallLoss()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.LInftyNorm" title="pycsou.func.penalty.LInftyNorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">LInftyNorm</span></code></a>.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.L21Norm">
<em class="property">class </em><code class="sig-name descname">L21Norm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">groups: numpy.ndarray</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L21Norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L21Norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.ProximableFunctional" title="pycsou.core.functional.ProximableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.ProximableFunctional</span></code></a></p>
<p><span class="math notranslate nohighlight">\(\ell_{2,1}\)</span>-norm, <span class="math notranslate nohighlight">\(\Vert\mathbf{x}\Vert_{2,1}:=\sum_{g=1}^G \sqrt{ \sum_{i\in\mathcal{G}_g} |x_i|^2}\,.\)</span></p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group_norm</span> <span class="o">=</span> <span class="n">L21Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">groups</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">group_norm</span><span class="p">)</span>
<span class="go">&lt;class &#39;pycsou.func.penalty.L21Norm&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">group_norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">21.44594499772297</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2_norm</span> <span class="o">=</span> <span class="n">L21Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">l2_norm</span><span class="p">)</span>
<span class="go">&lt;class &#39;pycsou.func.penalty.L2Norm&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1_norm</span> <span class="o">=</span> <span class="n">L21Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span><span class="n">groups</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">))</span> <span class="c1"># Also if groups = None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">l1_norm</span><span class="p">)</span>
<span class="go">&lt;class &#39;pycsou.func.penalty.L1Norm&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">single_group_l2</span> <span class="o">=</span> <span class="n">L2Norm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">group_norm</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">single_group_l2</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">),</span><span class="n">single_group_l2</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span><span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">))))</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math notranslate nohighlight">\(\ell_{2,1}\)</span>-norm penalty is convex and proximable. This penalty tends to produce group sparse solutions,
where all elements <span class="math notranslate nohighlight">\(x_i\)</span> for <span class="math notranslate nohighlight">\(i\in\mathcal{G}_g\)</span> for some <span class="math notranslate nohighlight">\(g\in\lbrace 1,2,\dots,G\)</span> tend to
be zero or non-zero jointly. A critical assumtion is that the groups are not overlapping, i.e.,
<span class="math notranslate nohighlight">\(\mathcal{G}_j \cap \mathcal{G}_i = \emptyset\)</span> for <span class="math notranslate nohighlight">\(j,i \in \lbrace 1,2,\dots,G\rbrace\)</span> such that <span class="math notranslate nohighlight">\(j\neq i.\)</span>
The proximal operator of the <span class="math notranslate nohighlight">\(\ell_{2,1}\)</span>-norm is obtained easily from that of the <span class="math notranslate nohighlight">\(\ell_2\)</span>-norm and the
separable sum property.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-func docutils literal notranslate"><span class="pre">L2Norm()</span></code>, <a class="reference internal" href="#pycsou.func.penalty.SquaredL2Norm" title="pycsou.func.penalty.SquaredL2Norm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SquaredL2Norm</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.L1Norm" title="pycsou.func.penalty.L1Norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">L1Norm()</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.L21Norm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">groups: numpy.ndarray</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L21Norm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L21Norm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>groups</strong> (<em>np.ndarray</em><em>, </em><em>optional</em><em>, </em><em>defaults to None</em>) – Numerical variable of the same size as <span class="math notranslate nohighlight">\(x\)</span>, where different
groups are distinguished by different values. If each element of <cite>x</cite>
belongs to a different group, an L1Norm is returned. If all elements
of <cite>x</cite> belong to the same group, an L2Norm is returned.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.L21Norm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L21Norm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L21Norm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.L21Norm.prox">
<code class="sig-name descname">prox</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray], tau: numbers.Number</em><span class="sig-paren">)</span> &#x2192; Union[numbers.Number, numpy.ndarray]<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#L21Norm.prox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.L21Norm.prox" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the proximity operator of the <code class="docutils literal notranslate"><span class="pre">tau</span></code>-scaled functional at the point <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which to perform the evaluation.</p></li>
<li><p><strong>tau</strong> (<em>Number</em>) – Scale.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Evaluation of the proximity operator of the <code class="docutils literal notranslate"><span class="pre">tau</span></code>-scaled functional at the point <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.NonNegativeOrthant">
<code class="sig-name descname">NonNegativeOrthant</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span> &#x2192; pycsou.func.base.IndicatorFunctional<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#NonNegativeOrthant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.NonNegativeOrthant" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the non negative orthant (positivity constraint).</p>
<p>It is used to enforce positive real solutions. It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\mathbf{x}\in \mathbb{R}^N_+,\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the non negative orthant.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">NonNegativeOrthant</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">func</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">proj_nonnegative_orthant</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">alltrue</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.LogBarrier" title="pycsou.func.penalty.LogBarrier"><code class="xref py py-func docutils literal notranslate"><span class="pre">LogBarrier()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.Segment">
<code class="sig-name descname">Segment</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">a: numbers.Number = 0</em>, <em class="sig-param">b: numbers.Number = 1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#Segment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.Segment" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the segment <span class="math notranslate nohighlight">\([a,b]\subset\mathbb{R}\)</span>.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\mathbf{x}\in [a,b]^N,\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>a</strong> (<em>Number</em>) – Left endpoint of the segement.</p></li>
<li><p><strong>b</strong> (<em>Number</em>) – Right endpoint of the segment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the segment <span class="math notranslate nohighlight">\([a,b]\subset\mathbb{R}\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">Segment</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">func</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">a_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">a_max</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">proj_segment</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([1, 1, 1, 1, 1, 2, 3, 4, 4, 4])</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.RealLine" title="pycsou.func.penalty.RealLine"><code class="xref py py-func docutils literal notranslate"><span class="pre">RealLine()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.ImagLine" title="pycsou.func.penalty.ImagLine"><code class="xref py py-func docutils literal notranslate"><span class="pre">ImagLine()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.RealLine">
<code class="sig-name descname">RealLine</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#RealLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.RealLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the real line <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\mathbf{x}\in \mathbb{R}^N,\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the real line <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">RealLine</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">func</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.NonNegativeOrthant" title="pycsou.func.penalty.NonNegativeOrthant"><code class="xref py py-func docutils literal notranslate"><span class="pre">NonNegativeOrthant()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.ImagLine" title="pycsou.func.penalty.ImagLine"><code class="xref py py-func docutils literal notranslate"><span class="pre">ImagLine()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pycsou.func.penalty.ImagLine">
<code class="sig-name descname">ImagLine</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#ImagLine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.ImagLine" title="Permalink to this definition">¶</a></dt>
<dd><p>Indicator function of the imaginary line <span class="math notranslate nohighlight">\(j\mathbb{R}\)</span>.</p>
<p>It is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\iota(\mathbf{x}):=\begin{cases}
 0 \,\text{if} \,\mathbf{x}\in (j\mathbb{R})^N,\\
  \, +\infty\,\text{ortherwise}.
  \end{cases}\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indicator function of the imaginary line <span class="math notranslate nohighlight">\(j\mathbb{R}\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>py:class:<cite>pycsou.core.functional.IndicatorFunctional</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">ImagLine</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">func</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="go">(inf, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.NonNegativeOrthant" title="pycsou.func.penalty.NonNegativeOrthant"><code class="xref py py-func docutils literal notranslate"><span class="pre">NonNegativeOrthant()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.RealLine" title="pycsou.func.penalty.RealLine"><code class="xref py py-func docutils literal notranslate"><span class="pre">RealLine()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.LogBarrier">
<em class="property">class </em><code class="sig-name descname">LogBarrier</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LogBarrier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LogBarrier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.ProximableFunctional" title="pycsou.core.functional.ProximableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.ProximableFunctional</span></code></a></p>
<p>Log barrier, <span class="math notranslate nohighlight">\(f(\mathbf{x}):= -\sum_{i=1}^N \log(x_i).\)</span></p>
<p>The log barrier is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x):=\begin{cases}
-\log(x) &amp; \text{if} \, x&gt;0,\\
+\infty &amp; \text{otherwise.}
\end{cases}\end{split}\]</div>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">LogBarrier</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(inf, -17.502307845873887)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="go">array([1., 2., 2., 3., 4., 5., 6., 7., 8., 9.])</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The log barrier can be used to enforce positivity in the solution.
Its proximal operator is given in <a class="reference internal" href="../../notes/references.html#proxalg" id="id11"><span>[ProxAlg]</span></a> Section 6.7.5.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.NonNegativeOrthant" title="pycsou.func.penalty.NonNegativeOrthant"><code class="xref py py-func docutils literal notranslate"><span class="pre">NonNegativeOrthant()</span></code></a>, <a class="reference internal" href="#pycsou.func.penalty.ShannonEntropy" title="pycsou.func.penalty.ShannonEntropy"><code class="xref py py-func docutils literal notranslate"><span class="pre">ShannonEntropy()</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.LogBarrier.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LogBarrier.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LogBarrier.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.LogBarrier.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LogBarrier.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LogBarrier.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.LogBarrier.prox">
<code class="sig-name descname">prox</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray], tau: numbers.Number</em><span class="sig-paren">)</span> &#x2192; Union[numbers.Number, numpy.ndarray]<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#LogBarrier.prox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.LogBarrier.prox" title="Permalink to this definition">¶</a></dt>
<dd><p>Proximal operator of the log barrier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Input.</p></li>
<li><p><strong>tau</strong> (<em>Number</em>) – Scaling constant.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Proximal point of x.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.ShannonEntropy">
<em class="property">class </em><code class="sig-name descname">ShannonEntropy</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#ShannonEntropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.ShannonEntropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.ProximableFunctional" title="pycsou.core.functional.ProximableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.ProximableFunctional</span></code></a></p>
<p>Negative Shannon entropy, <span class="math notranslate nohighlight">\(f(\mathbf{x}):= \sum_{i=1}^N x_i\log(x_i).\)</span></p>
<p>The (negative) Shannon entropy is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x):=\begin{cases}
x\log(x) &amp; \text{if} \, x&gt;0,\\
0&amp; \text{if} \, x=0,\\
+\infty &amp; \text{otherwise.}
\end{cases}\end{split}\]</div>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">ShannonEntropy</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">x1</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="n">func</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">(79.05697962199447, 23.02585092994046)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">prox</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">tau</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="go">array([0., 0., 1., 1., 1., 2., 2., 3., 3., 4.])</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>This regularization functional is based the information-theoretic notion of entropy, a mathematical generalisation of
entropy as introduced by Boltzmann in thermodynamics. It favours solutions with maximal entropy. The latter are typically
positive and featureless: smooth functions indeed carry much less spatial information than functions with sharp, localised features,
and hence have higher entropy. This penalty is restricted to positive solutions and often results in overly-smooth estimates.
Its proximal operator is given in <a class="reference internal" href="../../notes/references.html#proxsplit" id="id12"><span>[ProxSplit]</span></a> Table 2 or <a class="reference internal" href="#proxent" id="id13"><span>[ProxEnt]</span></a> Section 3.1.</p>
<dl class="citation">
<dt class="label" id="proxent"><span class="brackets"><a class="fn-backref" href="#id13">ProxEnt</a></span></dt>
<dd><p>Afef, Cherni, Chouzenoux Émilie, and Delsuc Marc-André. “Proximity operators for a class of hybrid sparsity+ entropy priors application to dosy NMR signal reconstruction.” 2016 International Symposium on Signal, Image, Video and Communications (ISIVC). IEEE, 2016.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.LogBarrier" title="pycsou.func.penalty.LogBarrier"><code class="xref py py-func docutils literal notranslate"><span class="pre">LogBarrier()</span></code></a>, <a class="reference internal" href="pycsou.func.loss.html#pycsou.func.loss.KLDivergence" title="pycsou.func.loss.KLDivergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">KLDivergence</span></code></a>.</p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.ShannonEntropy.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#ShannonEntropy.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.ShannonEntropy.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.ShannonEntropy.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#ShannonEntropy.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.ShannonEntropy.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.ShannonEntropy.prox">
<code class="sig-name descname">prox</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray], tau: numbers.Number</em><span class="sig-paren">)</span> &#x2192; Union[numbers.Number, numpy.ndarray]<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#ShannonEntropy.prox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.ShannonEntropy.prox" title="Permalink to this definition">¶</a></dt>
<dd><p>Proximal operator of the Shannon entropy functional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Input.</p></li>
<li><p><strong>tau</strong> (<em>Number</em>) – Scaling constant.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Proximal point of x.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycsou.func.penalty.QuadraticForm">
<em class="property">class </em><code class="sig-name descname">QuadraticForm</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">linop: Optional[pycsou.core.linop.LinearOperator] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#QuadraticForm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.QuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../classes/pycsou.core.functional.html#pycsou.core.functional.DifferentiableFunctional" title="pycsou.core.functional.DifferentiableFunctional"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycsou.core.functional.DifferentiableFunctional</span></code></a></p>
<p>Quadratic form <span class="math notranslate nohighlight">\(\mathbf{x}^\ast \mathbf{L} \mathbf{x}\)</span>.</p>
<p class="rubric">Examples</p>
<div class="highlight-pycon3 notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span>  <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">@</span> <span class="n">L</span> <span class="c1">#make definite positive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lop</span> <span class="o">=</span> <span class="n">DenseLinearOperator</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">linop</span><span class="o">=</span><span class="n">Lop</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Lop</span> <span class="o">@</span> <span class="n">x</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Lop</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<p>The quadratic form is defined as the functional <span class="math notranslate nohighlight">\(F:\mathbb{R}^n\to \mathbb{R}, \; \mathbf{x}\mapsto \mathbf{x}^\ast \mathbf{L}\mathbf{x}\)</span>
for some <em>positive semi-definite</em> linear operator <span class="math notranslate nohighlight">\(\mathbf{L}:\mathbb{R}^n\to \mathbb{R}^n\)</span>.
Its gradient is given by <span class="math notranslate nohighlight">\(\nabla F(\mathbf{x})=2 \mathbf{L}\mathbf{x}.\)</span> The latter is <span class="math notranslate nohighlight">\(\beta\)</span>-Lipschitz continuous with
<span class="math notranslate nohighlight">\(\beta=2\|\mathbf{L}\|_2.\)</span></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pycsou.func.penalty.SquaredL2Norm" title="pycsou.func.penalty.SquaredL2Norm"><code class="xref py py-func docutils literal notranslate"><span class="pre">SquaredL2Norm()</span></code></a></p>
</div>
<dl class="method">
<dt id="pycsou.func.penalty.QuadraticForm.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">dim: int</em>, <em class="sig-param">linop: Optional[pycsou.core.linop.LinearOperator] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pycsou/func/penalty.html#QuadraticForm.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.QuadraticForm.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – Dimension of the domain.</p></li>
<li><p><strong>linop</strong> (<a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><em>LinearOperator</em></a>) – Positive semi-definite operator defining the quadratic form. If <code class="docutils literal notranslate"><span class="pre">None</span></code> the identity operator is assumed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.QuadraticForm.__call__">
<code class="sig-name descname">__call__</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numbers.Number<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#QuadraticForm.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.QuadraticForm.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Argument of the map.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of <code class="docutils literal notranslate"><span class="pre">arg</span></code> through the map.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Number, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pycsou.func.penalty.QuadraticForm.jacobianT">
<code class="sig-name descname">jacobianT</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numbers.Number, numpy.ndarray]</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../../_modules/pycsou/func/penalty.html#QuadraticForm.jacobianT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycsou.func.penalty.QuadraticForm.jacobianT" title="Permalink to this definition">¶</a></dt>
<dd><p>Transpose of the Jacobian matrix of the differentiable map evaluated at <code class="docutils literal notranslate"><span class="pre">arg</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Union</em><em>[</em><em>Number</em><em>, </em><em>np.ndarray</em><em>]</em>) – Point at which the transposed Jacobian matrix is evaluated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Linear operator associated to the transposed Jacobian matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="../classes/pycsou.core.linop.html#pycsou.core.linop.LinearOperator" title="pycsou.core.linop.LinearOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearOperator</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pycsou.func.loss.html" class="btn btn-neutral float-right" title="Loss Functionals" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pycsou.func.base.html" class="btn btn-neutral float-left" title="Constructors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, Matthieu SIMEONI

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>